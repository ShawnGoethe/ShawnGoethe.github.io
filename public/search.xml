<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2020-03-06-BinaryTreeInorderTraversal</title>
      <link href="/2020/03/06/2020-03-06-BinaryTreeInorderTraversal/"/>
      <url>/2020/03/06/2020-03-06-BinaryTreeInorderTraversal/</url>
      
        <content type="html"><![CDATA[<h1 id="Problem94"><a href="#Problem94" class="headerlink" title="Problem94"></a>Problem94</h1><p>Given a binary tree, return the <em>inorder</em> traversal of its nodes’ values.</p><blockquote><p>给定一二叉树，中序遍历输出</p><p>ps:preorder,inorder,postorder，前中后</p></blockquote><h1 id="Key"><a href="#Key" class="headerlink" title="Key"></a>Key</h1><h2 id="recursive-approach"><a href="#recursive-approach" class="headerlink" title="recursive approach"></a>recursive approach</h2><p>利用递归解决B树的遍历问题，这种问题的代码其实大同小异，前中后的遍历输出，只需要调整递归部分即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//preorder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preorder</span><span class="params">(node t)</span></span></span><br><span class="line"><span class="function"><span class="title">if</span> <span class="params">(t != <span class="keyword">null</span>)</span> </span>&#123;</span><br><span class="line">System.out.print(t.value + <span class="string">" "</span>);</span><br><span class="line">preorder(t.left);</span><br><span class="line">preorder(t.right);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//inorder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inorder</span><span class="params">(node t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;</span><br><span class="line">inorder(t.left);</span><br><span class="line">System.out.print(t.value + <span class="string">" "</span>);</span><br><span class="line">inorder(t.right);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//postorder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postorder</span><span class="params">(node t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;</span><br><span class="line">        postorder(t.left);</span><br><span class="line">        postorder(t.right);</span><br><span class="line">        System.out.print(t.value + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//leverorder</span></span><br></pre></td></tr></table></figure><p>Solution</p><blockquote><p>Runtime: 0 ms, faster than 100.00% of Java online submissions for Binary Tree Inorder Traversal.</p><p>Memory Usage: 37.9 MB, less than 5.11% of Java online submissions for Binary Tree Inorder Traversal.</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * public class TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode left;</span></span><br><span class="line"><span class="comment"> *     TreeNode right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        List &lt; Integer &gt; res = <span class="keyword">new</span> ArrayList &lt; &gt; ();</span><br><span class="line">        inorder(root, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode root, List &lt; Integer &gt; res)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="keyword">null</span>) &#123;</span><br><span class="line">            inorder(root.left, res);</span><br><span class="line">            res.add(root.val);</span><br><span class="line">            inorder(root.right, res);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Complexity Analysis</p><ul><li>Time complexity : O(n)<em>O</em>(<em>n</em>). The time complexity is O(n)<em>O</em>(<em>n</em>) because the recursive function is T(n) = 2 \cdot T(n/2)+1<em>T</em>(<em>n</em>)=2⋅<em>T</em>(<em>n</em>/2)+1.</li><li>Space complexity : The worst case space required is O(n)<em>O</em>(<em>n</em>), and in the average case it’s O(\log n)<em>O</em>(log<em>n</em>) where n<em>n</em> is number of nodes.</li></ul><h2 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h2><p>solution还提供了另外一种方法通过stack pop的方式来完成：</p><p><a href="https://leetcode.com/problems/binary-tree-inorder-traversal/solution/" target="_blank" rel="noopener"><a href="https://leetcode.com/problems/binary-tree-inorder-traversal/solution/" target="_blank" rel="noopener">https://leetcode.com/problems/binary-tree-inorder-traversal/solution/</a></a></p><h2 id="Morris"><a href="#Morris" class="headerlink" title="Morris"></a>Morris</h2><p>同上</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-03-05-hexoNexTv7.7.2</title>
      <link href="/2020/03/05/2020-03-05-hexoNexTv7-7-2/"/>
      <url>/2020/03/05/2020-03-05-hexoNexTv7-7-2/</url>
      
        <content type="html"><![CDATA[<p>I find hexo’s theme:nexT v7.7.2 has some new features</p><h2 id="native-dark-mode"><a href="#native-dark-mode" class="headerlink" title="native dark mode"></a>native dark mode</h2><p>we can set </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">darkmode:true</span><br></pre></td></tr></table></figure><p>to open native dark mode</p><p>and there are other features like </p><ul><li><a href="https://docs.mathjax.org/en/latest/upgrading/whats-new-3.0.html" target="_blank" rel="noopener">support MathJax v3.0</a>,we use $$</li><li>add next_config helper</li></ul><h1 id="how-to-update-newest-version"><a href="#how-to-update-newest-version" class="headerlink" title="how to update newest version"></a>how to update newest version</h1><p>1.git clone <a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">https://github.com/theme-next/hexo-theme-next</a> themes/next</p><p>or in releases to download newest source code</p><p>2.copy file to hexo/theme/ such as :</p><p>/themes/hexo-theme-next-7.7.2/</p><p>3.open hexo’s _config.yml,and change theme’s value to hexo-theme-next-7.7.2 and u change your them successfully</p><p>4.update /themes/hexo-theme-next-7.7.2/_config.yml</p><p>Last , u can create new post to log your daily life</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn upgrade caniuse-lite browserslist</span><br></pre></td></tr></table></figure><p>and these days ,zehai.info ,may Expired ,sad </p>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NexT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-02-28-JS相关技术名词</title>
      <link href="/2020/02/28/2020-02-28-JS%E7%9B%B8%E5%85%B3%E6%8A%80%E6%9C%AF%E5%90%8D%E8%AF%8D/"/>
      <url>/2020/02/28/2020-02-28-JS%E7%9B%B8%E5%85%B3%E6%8A%80%E6%9C%AF%E5%90%8D%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<p>今天中午有收到Egg团队公开的文件调查，提及了很多技术名词，虽然不一定用到，但我也觉得列举出来会方便大家了解和比较，后续可能更新我用过的部分</p><h1 id="代码检查工具"><a href="#代码检查工具" class="headerlink" title="代码检查工具"></a>代码检查工具</h1><ul><li style="list-style: none"><input type="checkbox" checked> ESLint</li><li style="list-style: none"><input type="checkbox"> JSCS</li><li style="list-style: none"><input type="checkbox"> JSHint</li><li style="list-style: none"><input type="checkbox"> JSDoc</li><li style="list-style: none"><input type="checkbox"> Standard</li><li style="list-style: none"><input type="checkbox"> TSLint</li><li style="list-style: none"><input type="checkbox"> Flow</li></ul><table><thead><tr><th style="text-align:left"></th><th>引入目的：规范代码</th></tr></thead><tbody><tr><td style="text-align:left">ESLint</td><td>通过extend继承某一个大类，然后配置rules来进行代码规范</td></tr><tr><td style="text-align:left">JSCS</td><td></td></tr><tr><td style="text-align:left">JSHint</td><td></td></tr><tr><td style="text-align:left">JSDoc</td><td></td></tr><tr><td style="text-align:left">Standard</td><td></td></tr><tr><td style="text-align:left">TSLint</td><td></td></tr><tr><td style="text-align:left">Flow</td></tr></tbody></table><h2 id="使用感受"><a href="#使用感受" class="headerlink" title="使用感受"></a>使用感受</h2><p>解决了以下问题</p><ul><li>node是一门弱语言，进行校验（非变量类型校验，仅校验变量是否声明，是否可改等）</li><li>node在use strict模式下，eslint可以校验</li><li>团队合作，防止队友挖坑</li></ul><p>其实ESLint只是一种语法校验，更多的还有流程上的规范，就像网传阿里的开发规范一样，就好比node中你可以用类的语法糖，也可以用原型，当一件事情有多种实现方式时，需要规范来选择一个普遍公用的，易维护，易扩展的方案</p><p>除去语法校验，还有TS的类型校验，比如GIT的分支规范，如master,staging,backup,develop,other branch</p><h1 id="转义语言"><a href="#转义语言" class="headerlink" title="转义语言"></a>转义语言</h1><ul><li>[ x ] TS</li><li style="list-style: none"><input type="checkbox"> ClojureScript</li><li style="list-style: none"><input type="checkbox"> CoffeeScript</li><li style="list-style: none"><input type="checkbox"> Dart</li><li style="list-style: none"><input type="checkbox"> Elm</li><li style="list-style: none"><input type="checkbox"> Scala.js</li><li style="list-style: none"><input type="checkbox"> Haxe</li><li style="list-style: none"><input type="checkbox"> Nim</li><li style="list-style: none"><input type="checkbox"> PureScript</li><li style="list-style: none"><input type="checkbox"> Reason</li></ul><p>转移语言是2019年聊的比较多的，解决问题：</p><ul><li>类型校验，能够很好解决JS开发中，你不知道这个object里面有什么key，或者某个对象里面有什么方法（egg.js实际开发过程中，ctx.service.v1.handlexxx()就ctrl跳转不了，也不会有提示）</li></ul><h1 id="WEB框架"><a href="#WEB框架" class="headerlink" title="WEB框架"></a>WEB框架</h1><ul><li style="list-style: none"><input type="checkbox" checked> Express</li><li style="list-style: none"><input type="checkbox" checked> Koa</li><li style="list-style: none"><input type="checkbox" checked> Egg</li><li style="list-style: none"><input type="checkbox"> Nest.js</li><li style="list-style: none"><input type="checkbox"> Next.js</li><li style="list-style: none"><input type="checkbox"> Fastify.js</li><li style="list-style: none"><input type="checkbox"> Hapi.js</li><li style="list-style: none"><input type="checkbox"> Restify.js</li><li style="list-style: none"><input type="checkbox"> Loopback.io</li><li style="list-style: none"><input type="checkbox"> Sails.js</li><li style="list-style: none"><input type="checkbox"> Midway.js</li></ul><p>面试常被问到框架的问题，因为很多公司不会将项目搭建在原生的node服务上</p><ul><li>缺少约束，合作模式下，个人有个人的风格</li><li>项目配置繁琐，很多东西配置零散堆放</li><li>重复造轮子，框架提供较好的轮子</li><li>安全事宜，框架处理</li><li>etc</li></ul><p>一个好的框架事半功倍，<br><a href="https://expressjs.com/" target="_blank" rel="noopener">express</a>是一个非常轻量的框架</p><ul><li>fast</li><li>unopinionated(干净的)</li><li>minimalist</li></ul><p><a href="https://eggjs.org/" target="_blank" rel="noopener">Egg</a>是一个企业级框架，约定大于配置</p><ul><li>Provide capability to <a href="https://eggjs.org/en/advanced/framework.html" target="_blank" rel="noopener">customizd framework</a> base on Egg（可扩展）</li><li>Highly extensible <a href="https://eggjs.org/en/basics/plugin.html" target="_blank" rel="noopener">plugin mechanism</a>（插件牛逼）</li><li>Built-in <a href="https://eggjs.org/en/advanced/cluster-client.html" target="_blank" rel="noopener">cluster</a>（多进程牛逼）</li><li>Based on <a href="http://koajs.com/" target="_blank" rel="noopener">Koa</a> with high performance（企业级别性能优异）</li><li>Stable core framework with high test coverage（稳定）</li><li><a href="https://eggjs.org/en/tutorials/progressive.html" target="_blank" rel="noopener">Progressive development</a>（业务迭代，代码可以渐进继承）</li></ul><h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><ul><li style="list-style: none"><input type="checkbox" checked> MySQL</li><li style="list-style: none"><input type="checkbox" checked> PostgreSql</li><li style="list-style: none"><input type="checkbox" checked> Redis</li><li style="list-style: none"><input type="checkbox" checked> MongoDB</li><li style="list-style: none"><input type="checkbox"> SQL Server</li><li style="list-style: none"><input type="checkbox"> SQLLite</li><li style="list-style: none"><input type="checkbox"> influxdb</li><li style="list-style: none"><input type="checkbox"> HBASE</li><li style="list-style: none"><input type="checkbox"> TiDB</li><li style="list-style: none"><input type="checkbox"> Oracle</li><li style="list-style: none"><input type="checkbox"> DB2</li></ul><p>数据库是仅此于语言本身，另外的考点了，因为没有一个服务不涉猎存储，而</p><h1 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h1><ul><li style="list-style: none"><input type="checkbox"> Nginx</li><li style="list-style: none"><input type="checkbox"> Tomcat</li><li style="list-style: none"><input type="checkbox"> Apache</li></ul><h1 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h1><ul><li style="list-style: none"><input type="checkbox"> Docker</li><li style="list-style: none"><input type="checkbox"> PM2</li><li style="list-style: none"><input type="checkbox"> forever</li><li style="list-style: none"><input type="checkbox"> naught</li><li style="list-style: none"><input type="checkbox"> node-supervisor</li><li style="list-style: none"><input type="checkbox"> Supervisord(Unix)</li></ul><h1 id="RPC方式"><a href="#RPC方式" class="headerlink" title="RPC方式"></a>RPC方式</h1><ul><li style="list-style: none"><input type="checkbox"> HTTP</li><li style="list-style: none"><input type="checkbox"> Thrift</li><li style="list-style: none"><input type="checkbox"> gRPC</li><li style="list-style: none"><input type="checkbox"> dubbo</li><li style="list-style: none"><input type="checkbox"> MQ</li></ul><h1 id="开发场景"><a href="#开发场景" class="headerlink" title="开发场景"></a>开发场景</h1><ul><li style="list-style: none"><input type="checkbox"> 服务端API</li><li style="list-style: none"><input type="checkbox"> SSR应用</li><li style="list-style: none"><input type="checkbox"> Proxy层</li><li style="list-style: none"><input type="checkbox"> BFF层</li><li style="list-style: none"><input type="checkbox"> 代码片段，如Spark代码片段</li><li style="list-style: none"><input type="checkbox"> CLI &amp; 工具</li></ul><h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><ul><li style="list-style: none"><input type="checkbox"> </li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> List </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-31-JS设计模式</title>
      <link href="/2020/01/31/2020-01-31-JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/01/31/2020-01-31-JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>模式共计八种：</p><ul><li>单例模式</li><li>构造器模式</li><li>建造者模式</li><li>代理模式</li><li>外观模式</li><li>观察者模式</li><li>策略模式</li><li>迭代器模式</li></ul><p>设计模式的提出，为了更好的解耦，可拓展，服务可靠，不限定某种语言的实现</p><h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>一个类只有一个实例，如果存在就不实例化，如果不存在则new，以保证<strong>一个类只有一个实例</strong></p><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><ul><li>模块间通信</li><li>保证某个类的对象的唯一性</li><li>防止变量污染</li></ul><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><ul><li>this的使用</li><li>闭包容易stack over flow需要及时清理</li><li>创建新对象成本较高</li></ul><h2 id="实际案例"><a href="#实际案例" class="headerlink" title="实际案例"></a>实际案例</h2><p>如网站的计数器，多线程的线程池</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 养鱼游戏</span></span><br><span class="line">  <span class="keyword">let</span> fish = <span class="literal">null</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">catchFish</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 如果鱼存在,则直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(fish) &#123;</span><br><span class="line">      <span class="keyword">return</span> fish</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果鱼不存在,则获取鱼再返回</span></span><br><span class="line">      fish = <span class="built_in">document</span>.querySelector(<span class="string">'#cat'</span>)</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        fish,</span><br><span class="line">        water: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">let</span> water = <span class="keyword">this</span>.fish.getAttribute(<span class="string">'weight'</span>)</span><br><span class="line">          <span class="keyword">this</span>.fish.setAttribute(<span class="string">'weight'</span>, ++water)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 每隔3小时喂一次水</span></span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    catchFish().water()</span><br><span class="line">  &#125;, <span class="number">3</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><h1 id="构造器模式"><a href="#构造器模式" class="headerlink" title="构造器模式"></a>构造器模式</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-31-RomanToInteger</title>
      <link href="/2020/01/31/2020-01-31-RomanToInteger/"/>
      <url>/2020/01/31/2020-01-31-RomanToInteger/</url>
      
        <content type="html"><![CDATA[<h1 id="Leetcode13"><a href="#Leetcode13" class="headerlink" title="Leetcode13"></a>Leetcode13</h1><p>Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.</p><p>Symbol Value<br>I 1<br>V 5<br>X 10<br>L 50<br>C 100<br>D 500<br>M 1000<br>For example, two is written as II in Roman numeral, just two one’s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.</p><p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:</p><p>I can be placed before V (5) and X (10) to make 4 and 9.<br>X can be placed before L (50) and C (100) to make 40 and 90.<br>C can be placed before D (500) and M (1000) to make 400 and 900.<br>Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.</p><p>Example 1:</p><p>Input: “III”<br>Output: 3<br>Example 2:</p><p>Input: “IV”<br>Output: 4<br>Example 3:</p><p>Input: “IX”<br>Output: 9<br>Example 4:</p><p>Input: “LVIII”<br>Output: 58<br>Explanation: L = 50, V= 5, III = 3.<br>Example 5:</p><p>Input: “MCMXCIV”<br>Output: 1994<br>Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>题目意思其实很简单，掌握了计算方法其实很简单</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">romanToInt</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nums[]=<span class="keyword">new</span> <span class="keyword">int</span>[s.length()];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">        <span class="keyword">switch</span> (s.charAt(i))&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'M'</span>:</span><br><span class="line">                nums[i]=<span class="number">1000</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'D'</span>:</span><br><span class="line">                nums[i]=<span class="number">500</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'C'</span>:</span><br><span class="line">                nums[i]=<span class="number">100</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'L'</span>:</span><br><span class="line">                nums[i]=<span class="number">50</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'X'</span> :</span><br><span class="line">                nums[i]=<span class="number">10</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'V'</span>:</span><br><span class="line">                nums[i]=<span class="number">5</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">                nums[i]=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&lt;nums[i+<span class="number">1</span>])</span><br><span class="line">            sum-=nums[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            sum+=nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum+nums[nums.length-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-31-内网穿透</title>
      <link href="/2020/01/31/2020-01-31-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
      <url>/2020/01/31/2020-01-31-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>解决公网访问自己的内网设备（大部分公司，小区都是在内网中，IPv4历史原因导致），解决方案：</p><ul><li>路由器新增端口映射</li><li>花生壳动态解析软件</li><li>natapp等免费软件提供的内网映射服务</li><li>基于ngrok（不荐）或者frp自建内网映射服务</li></ul><h1 id="how"><a href="#how" class="headerlink" title="how"></a>how</h1><p>目前推荐使用frp搭建穿透服务，支持HTTP，SSH,TCP UDP FTP</p><p><img src="..\img\frp.png" alt=""></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-18-plugins</title>
      <link href="/2020/01/18/2020-01-18-plugins/"/>
      <url>/2020/01/18/2020-01-18-plugins/</url>
      
        <content type="html"><![CDATA[<p>最近更新hexo比较频繁，发现频繁性的推送master分支以及source源文件备份，比较繁琐，查询了官方文档，可以写一些监听函数，实现一些自动化部署，hexo默认将脚本放置在scripts文件夹下，以下代码可以在hexo new的时候自动打开默认编辑软件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var spawn = require(&apos;child_process&apos;).exec;</span><br><span class="line"></span><br><span class="line">hexo.on(&apos;new&apos;, function(data)&#123;</span><br><span class="line">  spawn(&apos;start  &quot;markdown编辑器绝对路径.exe&quot; &apos; + data.path);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>非常的方便，省去了我打开typora的时间</p><p>以及以下的代码可以实现自动部署source分支</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">require(&apos;shelljs/global&apos;);//记得安装包</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">hexo.on(&apos;deployAfter&apos;, function() &#123;//当deploy完成后执行备份</span><br><span class="line">run();</span><br><span class="line">&#125;);</span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">console.log(&quot;You make a wrong：&quot; + e.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function run() &#123;</span><br><span class="line">if (!which(&apos;git&apos;)) &#123;</span><br><span class="line">echo(&apos;Sorry, this script requires git&apos;);</span><br><span class="line">exit(1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo(&quot;======================Auto Backup Begin===========================&quot;);</span><br><span class="line">cd(&apos;./&apos;);</span><br><span class="line">if (exec(&apos;git add --all&apos;).code !== 0) &#123;</span><br><span class="line">echo(&apos;Error: Git add failed&apos;);</span><br><span class="line">exit(1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">if (exec(&apos;git commit -am &quot;Form auto backup script\&apos;s commit&quot;&apos;).code !== 0) &#123;</span><br><span class="line">echo(&apos;Error: Git commit failed&apos;);</span><br><span class="line">exit(1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">if (exec(&apos;git push origin source&apos;).code !== 0) &#123;</span><br><span class="line">echo(&apos;Error: Git push failed&apos;);</span><br><span class="line">exit(1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">echo(&quot;==================Auto Backup Complete============================&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a href="https://hexo.io/zh-cn/docs/plugins#%E5%B7%A5%E5%85%B7" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/plugins#%E5%B7%A5%E5%85%B7</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-17-ImplementStr</title>
      <link href="/2020/01/17/2020-01-17-ImplementStr/"/>
      <url>/2020/01/17/2020-01-17-ImplementStr/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCode28"><a href="#LeetCode28" class="headerlink" title="LeetCode28"></a>LeetCode28</h1><p>Implement strStr().</p><p>Return the index of the first occurrence of needle in haystack, or -1 if needle is not part of haystack.</p><p>Example 1:</p><p>Input: haystack = “hello”, needle = “ll”<br>Output: 2<br>Example 2:</p><p>Input: haystack = “aaaaa”, needle = “bba”<br>Output: -1<br>Clarification:</p><p>What should we return when needle is an empty string? This is a great question to ask during an interview.</p><p>For the purpose of this problem, we will return 0 when needle is an empty string. This is consistent to C’s strstr() and Java’s indexOf().</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>如果不考虑java偷懒的写法当然可以想到indexof的想法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> haystack.indexOf(needle);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Runtime: <span class="number">1</span> ms</span><br></pre></td></tr></table></figure></p><p>先按照题意写了如下代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(needle.length()==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(haystack.length()==<span class="number">0</span>)<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> index =-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;haystack.length();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(haystack.charAt(i)==needle.charAt(<span class="number">0</span>))&#123;</span><br><span class="line">                flag=<span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>;j&lt;needle.length();j++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(i+j&gt;=haystack.length())&#123;</span><br><span class="line">                        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(haystack.charAt(i+j)!=needle.charAt(j))&#123;</span><br><span class="line">                        flag=<span class="keyword">false</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">                    <span class="keyword">return</span>  i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Runtime: <span class="number">4</span> ms</span><br><span class="line">Memory Usage: <span class="number">42.7</span> MB</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-15-sqrtx</title>
      <link href="/2020/01/15/2020-01-15-sqrtx/"/>
      <url>/2020/01/15/2020-01-15-sqrtx/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCode-69"><a href="#LeetCode-69" class="headerlink" title="LeetCode-69"></a>LeetCode-69</h1><p>Implement int sqrt(int x).</p><p>Compute and return the square root of x, where x is guaranteed to be a non-negative integer.</p><p>Since the return type is an integer, the decimal digits are truncated and only the integer part of the result is returned.</p><p>Example 1:</p><p>Input: 4<br>Output: 2<br>Example 2:</p><p>Input: 8<br>Output: 2<br>Explanation: The square root of 8 is 2.82842…, and since<br>             the decimal part is truncated, 2 is returned.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>就是手写一个根号源码，首先想到的就是通过平方来做</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">46340</span>;i&lt;<span class="number">46341</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(x&gt;=(<span class="keyword">long</span>)i*i&amp;&amp;x&lt;(<span class="keyword">long</span>)(i+<span class="number">1</span>)*(i+<span class="number">1</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">Runtime: <span class="number">22</span> ms</span><br><span class="line">Memory Usage: <span class="number">34</span> MB</span><br></pre></td></tr></table></figure><p>如果不遵循题目的要求，使用Math函数，所以我们的目标大概是3ms附近</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> (<span class="keyword">int</span>)Math.sqrt(Double.parseDouble(String.valueOf(x)));</span><br><span class="line">    &#125;</span><br><span class="line">Runtime: <span class="number">3</span> ms</span><br></pre></td></tr></table></figure><p>解法粗暴，遇到大数的时候会从0重新开始计算，复杂度O(N)</p><h2 id="第一次优化"><a href="#第一次优化" class="headerlink" title="第一次优化"></a>第一次优化</h2><p>思路就是避免做两次乘法然后去比较，这个地方可以去优化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int mySqrt(int x) &#123;</span><br><span class="line">        long n = 1;</span><br><span class="line">        while(n * n &lt;= x) &#123;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        return (int) n - 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Runtime: 11 ms</span><br></pre></td></tr></table></figure><h2 id="第二次优化"><a href="#第二次优化" class="headerlink" title="第二次优化"></a>第二次优化</h2><p>可以使用二分法来逐步逼近i，没有必要从1开始顺序遍历</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (x == <span class="number">0</span> || x == <span class="number">1</span>) <span class="keyword">return</span> x;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> right = x;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> midPoint = (left + right) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (midPoint == x / midPoint) &#123;</span><br><span class="line">                <span class="keyword">return</span> midPoint;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (midPoint &gt; x / midPoint) &#123;</span><br><span class="line">                right = midPoint;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (midPoint &lt; x / midPoint) &#123;</span><br><span class="line">                left = midPoint + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> left - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Runtime: <span class="number">1</span> ms</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-11-SameTree</title>
      <link href="/2020/01/11/2020-01-11-SameTree/"/>
      <url>/2020/01/11/2020-01-11-SameTree/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCode-100"><a href="#LeetCode-100" class="headerlink" title="LeetCode 100"></a>LeetCode 100</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Given two binary trees, write a function to check if they are the same or not.</span><br><span class="line"></span><br><span class="line">Two binary trees are considered the same if they are structurally identical and the nodes have the same value.</span><br><span class="line"></span><br><span class="line">Example 1:</span><br><span class="line"></span><br><span class="line">Input:     1         1</span><br><span class="line">          / \       / \</span><br><span class="line">         2   3     2   3</span><br><span class="line"></span><br><span class="line">        [1,2,3],   [1,2,3]</span><br><span class="line"></span><br><span class="line">Output: true</span><br><span class="line">Example 2:</span><br><span class="line"></span><br><span class="line">Input:     1         1</span><br><span class="line">          /           \</span><br><span class="line">         2             2</span><br><span class="line"></span><br><span class="line">        [1,2],     [1,null,2]</span><br><span class="line"></span><br><span class="line">Output: false</span><br><span class="line">Example 3:</span><br><span class="line"></span><br><span class="line">Input:     1         1</span><br><span class="line">          / \       / \</span><br><span class="line">         2   1     1   2</span><br><span class="line"></span><br><span class="line">        [1,2,1],   [1,1,2]</span><br><span class="line"></span><br><span class="line">Output: false</span><br></pre></td></tr></table></figure><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>题目其实很简单的一个递归Recursion,我们很轻松可以通过递归来解决<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">  public boolean isSameTree(TreeNode p, TreeNode q) &#123;</span><br><span class="line">    // p and q are both null</span><br><span class="line">    if (p == null &amp;&amp; q == null) return true;</span><br><span class="line">    // one of p and q is null</span><br><span class="line">    if (q == null || p == null) return false;</span><br><span class="line">    if (p.val != q.val) return false;</span><br><span class="line">    return isSameTree(p.right, q.right) &amp;&amp;</span><br><span class="line">            isSameTree(p.left, q.left);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>时间复杂度为O(n)，控件复杂度为O(logn)~O(n)之间，这道题就不考虑其他解法了，recursion目前看来是最优解</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-10-MatrixZero</title>
      <link href="/2020/01/10/2020-01-10-MatrixZero/"/>
      <url>/2020/01/10/2020-01-10-MatrixZero/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCode-73"><a href="#LeetCode-73" class="headerlink" title="LeetCode 73"></a>LeetCode 73</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Given a m x n matrix, if an element is 0, set its entire row and column to 0. Do it in-place.</span><br><span class="line"></span><br><span class="line">Example 1:</span><br><span class="line"></span><br><span class="line">Input: </span><br><span class="line">[</span><br><span class="line">  [1,1,1],</span><br><span class="line">  [1,0,1],</span><br><span class="line">  [1,1,1]</span><br><span class="line">]</span><br><span class="line">Output: </span><br><span class="line">[</span><br><span class="line">  [1,0,1],</span><br><span class="line">  [0,0,0],</span><br><span class="line">  [1,0,1]</span><br><span class="line">]</span><br><span class="line">Example 2:</span><br><span class="line"></span><br><span class="line">Input: </span><br><span class="line">[</span><br><span class="line">  [0,1,2,0],</span><br><span class="line">  [3,4,5,2],</span><br><span class="line">  [1,3,1,5]</span><br><span class="line">]</span><br><span class="line">Output: </span><br><span class="line">[</span><br><span class="line">  [0,0,0,0],</span><br><span class="line">  [0,4,5,0],</span><br><span class="line">  [0,3,1,0]</span><br><span class="line">]</span><br><span class="line">Follow up:</span><br><span class="line"></span><br><span class="line">A straight forward solution using O(mn) space is probably a bad idea.</span><br><span class="line">A simple improvement uses O(m + n) space, but still not the best solution.</span><br><span class="line">Could you devise a constant space solution?</span><br></pre></td></tr></table></figure><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>一开始以为递归可以解决，可以将矩阵一层层拆开，写下了如下的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public void setZeroes(int[][] matrix) &#123;</span><br><span class="line">    int rows = matrix.length-1;</span><br><span class="line">    int cols = matrix[0].length-1;</span><br><span class="line">    regression(matrix, rows&gt;=cols?cols:rows);</span><br><span class="line">&#125;</span><br><span class="line">public void regression(int[][] matrix,int index)&#123;</span><br><span class="line">    if(index&lt;0)&#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    boolean flag = false;</span><br><span class="line">    for(int i =index;i&lt;matrix[0].length;i++)&#123;</span><br><span class="line">        if(matrix[index][i]==0)</span><br><span class="line">        &#123;</span><br><span class="line">            handleZero(matrix,i);</span><br><span class="line">            flag=true;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if(flag==false)&#123;</span><br><span class="line">        for(int j =index;j&lt;matrix.length;j++)&#123;</span><br><span class="line">            if(matrix[j][index]==0)</span><br><span class="line">            &#123;</span><br><span class="line">                handleZero(matrix,j);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    regression(matrix, --index);</span><br><span class="line">&#125;</span><br><span class="line">private void handleZero(int[][] matrix,int pos) &#123;</span><br><span class="line"></span><br><span class="line">    for(int i=matrix[0].length-1;i&gt;=pos;i--)&#123;</span><br><span class="line">        matrix[pos][i]=0;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int j=matrix.length-1;j&gt;=pos;j--)&#123;</span><br><span class="line">        matrix[j][pos]=0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>写完后很快发现不能够实现，原因就在于他只能管理到内层，外层标为0后，没办法做额外的标记（其实生产代码可以打一些标记），所以只能抛弃这个本以为很简单的方法，该用了set合集去记录要设置0行列的行号或者列号，这个复杂度并不是很复杂，但是执行完发现代码的效率还是很低，先放代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">  public void setZeroes(int[][] matrix) &#123;</span><br><span class="line">    int R = matrix.length;</span><br><span class="line">    int C = matrix[0].length;</span><br><span class="line">    Set&lt;Integer&gt; rows = new HashSet&lt;Integer&gt;();</span><br><span class="line">    Set&lt;Integer&gt; cols = new HashSet&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; R; i++) &#123;</span><br><span class="line">      for (int j = 0; j &lt; C; j++) &#123;</span><br><span class="line">        if (matrix[i][j] == 0) &#123;</span><br><span class="line">          rows.add(i);</span><br><span class="line">          cols.add(j);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; R; i++) &#123;</span><br><span class="line">      for (int j = 0; j &lt; C; j++) &#123;</span><br><span class="line">        if (rows.contains(i) || cols.contains(j)) &#123;</span><br><span class="line">          matrix[i][j] = 0;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>代码低效的原因在于动用了两层循环，时间复杂度非常低，题目的置0是有规律的，不是无规律的，所以我开始寻求更新简单的方法,先贴最优解，要睡觉了，我的头发啊</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public void setZeroes(int[][] matrix) &#123;</span><br><span class="line">int R = matrix.length;</span><br><span class="line">int C = matrix[0].length;</span><br><span class="line">boolean isCol = false;</span><br><span class="line"></span><br><span class="line">for(int i=0; i&lt;R; i++) &#123;</span><br><span class="line">if (matrix[i][0] == 0) &#123;</span><br><span class="line">        isCol = true;</span><br><span class="line">    &#125;</span><br><span class="line">for(int j=1; j&lt;C; j++) &#123;</span><br><span class="line">if(matrix[i][j]==0) &#123;</span><br><span class="line">matrix[0][j] = 0;</span><br><span class="line">matrix[i][0] = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Iterate over the array once again and using the first row and first column, update the elements.</span><br><span class="line">for(int i=1; i&lt;R; i++) &#123;</span><br><span class="line">for(int j=1; j&lt;C; j++) &#123;</span><br><span class="line">if(matrix[i][0]==0 || matrix[0][j]==0) &#123;</span><br><span class="line">matrix[i][j] = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// See if the first row needs to be set to zero as well</span><br><span class="line">if(matrix[0][0]==0) &#123;</span><br><span class="line">for(int j=0; j&lt;C; j++) &#123;</span><br><span class="line">matrix[0][j] = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// See if the first column needs to be set to zero as well</span><br><span class="line">if(isCol) &#123;</span><br><span class="line">for(int i=0; i&lt;R; i++) &#123;</span><br><span class="line">matrix[i][0] = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-09-RedisTransaction</title>
      <link href="/2020/01/09/2020-01-09-RidisTransaction/"/>
      <url>/2020/01/09/2020-01-09-RidisTransaction/</url>
      
        <content type="html"><![CDATA[<blockquote><p>官网doc：<a href="https://redis.io/topics/transactions" target="_blank" rel="noopener">https://redis.io/topics/transactions</a></p><p>本文纯属阅读笔记，无学术参考价值</p></blockquote><h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>事务（transaction）的本质就是处理好几个动作，要么都成功，要么其中一个失败就全部回滚</p><p>每门语言都会有事务的支持，node也有async的方法实现事务几个动作串行，或者并行，一个失败全部回滚，之前写过支付的例子，使用async.waterfall,购买会员后</p><p>1.查询支付宝返回支付是否成功</p><p>2.获取用户所买会员的等级及相关权限</p><p>3.将权益插入用户表中</p><p>4.将订单数据记录到订单表中，方便后台查看订单量</p><p>大致步骤就是这些</p><p>Redis主要使用MULTI ,EXEC,DISCARD WATCH来实现事务的功能</p><p>遵循以下原则：</p><ul><li>所有命令被序列化后顺序执行，且执行期间不接受其他请求，保证隔离性</li><li>EXEC命令触发事务中所有命令的执行，因此，如果客户端调用MULTI命令之前失去连接，则不执行任何操作。如果EXEC命令调用过，则所有的命令都会被执行</li></ul><h1 id="how"><a href="#how" class="headerlink" title="how"></a>how</h1><p>MULTI输入事务以OK答复，此时用户可以发送多个命令，Redis都不会执行，而是排队，一旦调用EXEC，则将会执行所有命令，调用DISCARD将刷新（Flush？清空？重新执行？）事务队列并退出事务</p><p>示例代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">&gt; INCR foo</span><br><span class="line">QUEUED</span><br><span class="line">&gt; INCR bar</span><br><span class="line">QUEUED</span><br><span class="line">&gt; EXEC</span><br><span class="line">1) (integer) 1</span><br><span class="line">2) (integer) 1</span><br></pre></td></tr></table></figure><p>可以看出EXEC返回一个数组，其中每个元素都是事务中单个命令的答复，其发出顺序与命令相同</p><p>当Reids连接处于MULTI的请求时，所有的命令都将以字符串queued答复，当EXEC时，将顺序执行</p><h2 id="errors"><a href="#errors" class="headerlink" title="errors"></a>errors</h2><p>可能存在两种命令错误：</p><ul><li>命令可能无法排队，因此在EXEC之前可能有错误（包括命令语法错误）</li><li>调用EXEC后，命令执行失败</li></ul><p>客户端通过检查已排队（queued）的命令返回值来判断第一种错误，另外从2.6.5开始，服务器将记住在命令排队期间发生的错误，并且拒绝执行事务，返回错误并自动丢弃事务</p><p><strong>EXEC执行后错误不会特殊处理，所有的命令都将被执及时有些命令失败</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">+OK</span><br><span class="line">SET a abc</span><br><span class="line">+QUEUED</span><br><span class="line">LPOP a</span><br><span class="line">+QUEUED</span><br><span class="line">EXEC</span><br><span class="line">*2</span><br><span class="line">+OK</span><br><span class="line">-ERR Operation against a key holding the wrong kind of value</span><br></pre></td></tr></table></figure><p><strong>即时命令失败，队列里的其他命令也会处理</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    name:stu</span><br><span class="line">    time:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Transaction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-08-SortColors</title>
      <link href="/2020/01/08/2020-01-08-SortColors/"/>
      <url>/2020/01/08/2020-01-08-SortColors/</url>
      
        <content type="html"><![CDATA[<h1 id="Leetcode-75"><a href="#Leetcode-75" class="headerlink" title="Leetcode-75"></a>Leetcode-75</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Given an array with n objects colored red, white or blue, sort them in-place so that objects of the same color are adjacent, with the colors in the order red, white and blue.</span><br><span class="line"></span><br><span class="line">Here, we will use the integers 0, 1, and 2 to represent the color red, white, and blue respectively.</span><br><span class="line"></span><br><span class="line">Note: You are not suppose to use the library&apos;s sort function for this problem.</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line"></span><br><span class="line">Input: [2,0,2,1,1,0]</span><br><span class="line">Output: [0,0,1,1,2,2]</span><br><span class="line">Follow up:</span><br><span class="line"></span><br><span class="line">A rather straight forward solution is a two-pass algorithm using counting sort.</span><br><span class="line">First, iterate the array counting number of 0&apos;s, 1&apos;s, and 2&apos;s, then overwrite array with total number of 0&apos;s, then 1&apos;s and followed by 2&apos;s.</span><br><span class="line">Could you come up with a one-pass algorithm using only constant space?</span><br></pre></td></tr></table></figure><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><p>题目乍一看非常简单,但确实说使用简单的sort方法以及o(n^2)的排序确实会浪费时间复杂度，本着好奇心，我试了一下，果然成了吊车尾</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sortColors</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;nums.length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]&gt;nums[j])&#123;</span><br><span class="line">                    <span class="keyword">int</span> tmp=nums[i];</span><br><span class="line">                    nums[i]=nums[j];</span><br><span class="line">                    nums[j]=tmp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Runtime: <span class="number">1</span> ms, faster than <span class="number">6.35</span>% of Java online submissions <span class="keyword">for</span> Sort Colors.</span><br></pre></td></tr></table></figure><p>该题优化的核心位置是该数组是一个一维数组，设置两个指针，左边遍历0，遇到0往左放，遇到2往右放，r和l为左右分界线，index记录最后一个0的位置<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sortColors</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> r = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[l] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(l &gt; index) &#123;</span><br><span class="line">                    <span class="keyword">int</span> tmp = nums[index];</span><br><span class="line">                    nums[index] = nums[l];</span><br><span class="line">                    nums[l] = tmp;</span><br><span class="line">                    index++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    l++;</span><br><span class="line">                    index++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[l] == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = nums[r];</span><br><span class="line">                nums[r] = <span class="number">2</span>;</span><br><span class="line">                nums[l] = tmp;</span><br><span class="line">                r--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> l++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-08-MinimunPathSum</title>
      <link href="/2020/01/08/2020-01-08-MinimumPathSum/"/>
      <url>/2020/01/08/2020-01-08-MinimumPathSum/</url>
      
        <content type="html"><![CDATA[<h1 id="Leetcode-64"><a href="#Leetcode-64" class="headerlink" title="Leetcode-64"></a>Leetcode-64</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Given a m x n grid filled with non-negative numbers, find a path from top left to bottom right which minimizes the sum of all numbers along its path.</span><br><span class="line"></span><br><span class="line">Note: You can only move either down or right at any point in time.</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line"></span><br><span class="line">Input:</span><br><span class="line">[</span><br><span class="line">  [1,3,1],</span><br><span class="line">  [1,5,1],</span><br><span class="line">  [4,2,1]</span><br><span class="line">]</span><br><span class="line">Output: 7</span><br><span class="line">Explanation: Because the path 1→3→1→1→1 minimizes the sum.</span><br></pre></td></tr></table></figure><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><p>解法为简单的动态规划，只要找到比较该元素，上方和左方的值的最小值，然后与该值相加，就可以得到解</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int minPathSum(int[][] grid) &#123;</span><br><span class="line">        for(int i=1; i&lt;grid.length; i++) grid[i][0] += grid[i-1][0];</span><br><span class="line">        for(int j=1; j&lt;grid[0].length; j++) grid[0][j] += grid[0][j-1];</span><br><span class="line">        for (int i=1; i&lt;grid.length; i++) &#123;</span><br><span class="line">            for (int j=1; j&lt;grid[0].length; j++) &#123;</span><br><span class="line">                grid[i][j] = Math.min(grid[i][j-1], grid[i-1][j]) + grid[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return grid[grid.length-1][grid[0].length-1];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-07-关于Promise的思考</title>
      <link href="/2020/01/07/2020-01-07-%E5%85%B3%E4%BA%8EPromise%E7%9A%84%E6%80%9D%E8%80%83/"/>
      <url>/2020/01/07/2020-01-07-%E5%85%B3%E4%BA%8EPromise%E7%9A%84%E6%80%9D%E8%80%83/</url>
      
        <content type="html"><![CDATA[<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>（这道题在互联网上已经有了）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可以添加任务，任务包含任务数据，任务延迟触发的等待时间。</span><br><span class="line">在任务到达触发时间点时，自动触发执行此任务。</span><br><span class="line">队列中任务保持先进先出原则：假设 A 任务的触发等待时间为 X，B 任务的触发等待时间为 Y，B 在 A 之后被添加入队列，则 A 的前驱任务执行完成后等待时间 X 后，才执行 A，同理在 A 执行完成后，等待时间 Y，才执行 B。</span><br></pre></td></tr></table></figure><h1 id="思路过程"><a href="#思路过程" class="headerlink" title="思路过程"></a>思路过程</h1><h2 id="1-Java上线"><a href="#1-Java上线" class="headerlink" title="1.Java上线"></a>1.Java上线</h2><p>读题目就是<strong>延时队列</strong>的特征，Java有锁，有多线程，写起来多方便</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.BlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.DelayQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Delayed;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandWritingQueue</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> BlockingQueue&lt;DelayedElement&gt; deque = <span class="keyword">new</span> DelayQueue&lt;&gt;();</span><br><span class="line">        Runnable producerRunnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="keyword">true</span> &amp;&amp; i&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        --i;</span><br><span class="line">                        System.out.println(<span class="string">"producing "</span>+i+<span class="string">",wait "</span>+i+<span class="string">" seconds"</span>);</span><br><span class="line">                        deque.put(<span class="keyword">new</span> DelayedElement(<span class="number">1000</span> * i, <span class="string">"i="</span> + i));</span><br><span class="line">                        Thread.sleep(<span class="number">200</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        Runnable customerRunnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        System.out.println(<span class="string">"consuming:"</span> + deque.take().msg);</span><br><span class="line">                        <span class="comment">//Thread.sleep(500);</span></span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Runnable getSize= <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"size="</span>+deque.size());</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread(producerRunnable);</span><br><span class="line">        thread1.start();</span><br><span class="line"></span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread(customerRunnable);</span><br><span class="line">        thread2.start();</span><br><span class="line"></span><br><span class="line">        Thread thread3 = <span class="keyword">new</span> Thread(getSize);</span><br><span class="line">        thread3.start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DelayedElement</span> <span class="keyword">implements</span> <span class="title">Delayed</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> expire;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String msg;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DelayedElement</span><span class="params">(<span class="keyword">long</span> delay, String msg)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.msg = msg;</span><br><span class="line">            expire = System.currentTimeMillis() + delay;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getDelay</span><span class="params">(TimeUnit unit)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> unit.convert(<span class="keyword">this</span>.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Delayed o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span>  -<span class="number">1</span>;<span class="comment">//FIFO</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-Node上线"><a href="#2-Node上线" class="headerlink" title="2.Node上线"></a>2.Node上线</h2><p>被提醒该题目可以用node实现，且不需要借助redis来做，然后我上手就是一把操作：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DelayElement</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(data, expire) &#123;</span><br><span class="line">    <span class="keyword">this</span>.data = data;</span><br><span class="line">    <span class="keyword">this</span>.expire = expire;<span class="comment">//second</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> delayArray = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">//push two element in delayArray</span></span><br><span class="line">delayArray.push(<span class="keyword">new</span> DelayElement(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">delayArray.push(<span class="keyword">new</span> DelayElement(<span class="number">2</span>, <span class="number">1</span>));</span><br><span class="line"><span class="keyword">let</span> length = delayArray.length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> time_cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (delayArray.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> de = delayArray.shift();</span><br><span class="line">  time_cnt += de.expire;<span class="comment">//serial</span></span><br><span class="line">  (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'expire data is :'</span> + de.data + <span class="string">',expire time is :'</span> + de.expire);</span><br><span class="line">    &#125;, time_cnt * <span class="number">1000</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我以为设计的考点也就是立即执行函数，延时的使用，但是这里的for循环是个伪串行，实际上是并发的，也为第三步的修改提供了bug</p><h2 id="3-Promise时代"><a href="#3-Promise时代" class="headerlink" title="3.Promise时代"></a>3.Promise时代</h2><p>一开始我是想把async函数放进去，写了如下的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> delayArray = [];</span><br><span class="line"><span class="keyword">const</span> daPush = <span class="function">(<span class="params">data, expire</span>) =&gt;</span> &#123;</span><br><span class="line">  delayArray.push(<span class="keyword">async</span> () =&gt;  &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'data is '</span> + data + <span class="string">' and expire is '</span> + expire);</span><br><span class="line">    &#125;, expire * <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">daPush(<span class="number">1</span>, <span class="number">4</span>);<span class="comment">//2 seconds</span></span><br><span class="line">daPush(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> da <span class="keyword">of</span> delayArray) &#123;</span><br><span class="line">    <span class="keyword">await</span> da();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>发现代码还是串行的，然后查了一下可能的问题（以下为个人猜测，欢迎指正）async声明的函数会包装成Promise不假，但是for循环会并发去执行await中的async</p><p>4.正解</p><p><del>promise执行会阻塞主线程</del></p><p>Macrotasks和Microtasks 都属于上述的异步任务中的一种，他们分别有如下API：<br><strong>macrotasks:</strong> setTimeout, setInterval, setImmediate, I/O, UI rendering<br><strong>microtasks:</strong> process.nextTick, Promise, MutationObserver</p><p>任务队列中，在每一次事件循环中，<strong>macrotask</strong>只会<strong>提取一个执行</strong>，而<strong>microtask</strong>会<strong>一直</strong>提取，直到microsoft队列<strong>为空</strong>为止。</p><p>也就是说如果某个microtask任务被推入到执行中，那么当主线程任务执行完成后，会循环调用该队列任务中的下一个任务来执行，直到该任务队列到最后一个任务为止。</p><p>而事件循环每次只会入栈一个macrotask,<strong>主线程</strong>执行完成该任务后又会检查<strong>microtasks</strong>队列并完成里面的所有任务后再执行<strong>macrotask</strong>的任务。</p><p>以及macrotask应该对应的是check队列（该行未验证）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> delayArray = [];</span><br><span class="line"><span class="keyword">const</span> daPush = <span class="function">(<span class="params">data, expire</span>) =&gt;</span> &#123;</span><br><span class="line">  delayArray.push(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(data)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'data is '</span> + data + <span class="string">' and expire is '</span> + expire);</span><br><span class="line">        resolve(<span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        reject(<span class="string">'there is nodata'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, expire * <span class="number">1000</span>);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;;</span><br><span class="line">daPush(<span class="number">1</span>, <span class="number">4</span>);<span class="comment">//2 seconds</span></span><br><span class="line">daPush(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> da <span class="keyword">of</span> delayArray) &#123;</span><br><span class="line">    da().then(<span class="function">(<span class="params">value</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="comment">// console.log(value);</span></span><br><span class="line">    &#125;).catch(<span class="function">(<span class="params">value</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(value);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//没有28-33，只35行也可以</span></span><br><span class="line">    <span class="comment">// await da();</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-07-SetTimeout</title>
      <link href="/2020/01/07/2020-01-07-SetTimeout/"/>
      <url>/2020/01/07/2020-01-07-SetTimeout/</url>
      
        <content type="html"><![CDATA[<p>执行了一下程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while(true)&#123;</span><br><span class="line">    setTimeout(()=&gt;&#123;</span><br><span class="line">        console.log(1)</span><br><span class="line">    &#125;,0)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>返回了一下内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;--- Last few GCs ---&gt;</span><br><span class="line"></span><br><span class="line">[12308:000001E565C2F6F0]    14167 ms: Mark-sweep 1395.9 (1425.2) -&gt; 1395.9 (1423.7) MB, 1754.1 / 0.0 ms  (+ 0.0 ms in 39 steps since start of marking, biggest step 0.0 ms, walltime since start of marking 1764 ms) (average mu = 0.105, current mu = 0.020) a[12308:000001E565C2F6F0]    14175 ms: Scavenge 1397.3 (1423.7) -&gt; 1397.3 (1425.2) MB, 7.0 / 0.0 ms  (average mu = 0.105, current mu = 0.020) allocation failure</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;--- JS stacktrace ---&gt;</span><br><span class="line"></span><br><span class="line">==== JS stack trace =========================================</span><br><span class="line"></span><br><span class="line">    0: ExitFrame [pc: 000002AFCABDC5C1]</span><br><span class="line">Security context: 0x037b5391e6e9 &lt;JSObject&gt;</span><br><span class="line">    1: /* anonymous */ [0000016D4360B9A1] [D:\working\h3yun\test.3.js:~1] [pc=000002AFCAC7210F](this=0x016d4360bad1 &lt;Object map = 000001F79EE82571&gt;,exports=0x016d4360bad1 &lt;Object map = 000001F79EE82571&gt;,require=0x016d4360ba91 &lt;JSFunction require (sfi = 00000397F3EC6A31)&gt;,module=0x016d4360ba09 &lt;Module map = 000001F79EED3DA1&gt;,__filename=0x0397f3ece219 &lt;Strin...</span><br><span class="line"></span><br><span class="line">FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory</span><br><span class="line"> 1: 00007FF7C7BFC6AA v8::internal::GCIdleTimeHandler::GCIdleTimeHandler+4506</span><br><span class="line"> 2: 00007FF7C7BD7416 node::MakeCallback+4534</span><br><span class="line"> 3: 00007FF7C7BD7D90 node_module_register+2032</span><br><span class="line"> 4: 00007FF7C7EF189E v8::internal::FatalProcessOutOfMemory+846</span><br><span class="line"> 5: 00007FF7C7EF17CF v8::internal::FatalProcessOutOfMemory+639</span><br><span class="line"> 6: 00007FF7C80D7F94 v8::internal::Heap::MaxHeapGrowingFactor+9620</span><br><span class="line"> 7: 00007FF7C80CEF76 v8::internal::ScavengeJob::operator=+24550</span><br><span class="line"> 8: 00007FF7C80CD5CC v8::internal::ScavengeJob::operator=+17980</span><br><span class="line"> 9: 00007FF7C80D6317 v8::internal::Heap::MaxHeapGrowingFactor+2327</span><br><span class="line">10: 00007FF7C80D6396 v8::internal::Heap::MaxHeapGrowingFactor+2454</span><br><span class="line">11: 00007FF7C8200637 v8::internal::Factory::NewFillerObject+55</span><br><span class="line">12: 00007FF7C827D826 v8::internal::operator&lt;&lt;+73494</span><br><span class="line">13: 000002AFCABDC5C1</span><br></pre></td></tr></table></figure><h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>因为业务代码阻塞住，没有进入timer_handler的循环，所以1虽然进入了timer的红黑树中，但是不可能输出，不像之前for循环会有一个截止条件，后续的定时器还是可以生效的</p><p>另外有一个地方记混了，遍历回调的时候，会执行直到回调为空或者最大执行回调数量，而业务代码只会在这里阻塞不会停止，这也是为何出现GC的日志</p><h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>setimeout是JS前端常用的控件用来延时执行一个函数（回调），当执行业务代码的时候我们会将settimeout，setImmediate，nextTick，setInterval插入timer_handler的不同队列中（详见左侧node分支，且文章也在更新中），当JS单线程执行完业务代码后，才开始eventloop查找观察者来进行回调，当然也存在延时不精确的可能</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-06-gRPC</title>
      <link href="/2020/01/06/2020-01-06-gRPC/"/>
      <url>/2020/01/06/2020-01-06-gRPC/</url>
      
        <content type="html"><![CDATA[<h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>gRPC是任何环境都可以运行的高性能开源框架，他可以通过pluggable support来高效实现负载均衡，心跳检测和授权，他也可以应用于分布式计算的最后一个流程（连接各个端到后端）</p><ul><li>简单的服务定义</li><li>快速启动易扩展</li><li>跨语言，跨平台</li><li>双向流和鉴权</li></ul><h1 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h1><ul><li><p>gRPC可以通过protobuf来定义接口，从而可以有更加严格的接口约束条件。关于protobuf可以参见笔者之前的小文<a href="https://www.jianshu.com/p/b723053a86a6" target="_blank" rel="noopener">Google Protobuf简明教程</a> </p></li><li><p>另外，通过protobuf可以将数据序列化为二进制编码，这会大幅减少需要传输的数据量，从而大幅提高性能。</p></li><li><p>gRPC可以方便地支持流式通信(理论上通过http2.0就可以使用streaming模式, 但是通常web服务的restful api似乎很少这么用，通常的流式数据应用如视频流，一般都会使用专门的协议如HLS，RTMP等，这些就不是我们通常web服务了，而是有专门的服务器应用。）</p></li></ul><h1 id="node"><a href="#node" class="headerlink" title="node"></a>node</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ # Clone the repository to get the example code</span><br><span class="line">$ git clone -b v1.25.0 https://github.com/grpc/grpc</span><br><span class="line">$ # Navigate to the dynamic codegen &quot;hello, world&quot; Node example:</span><br><span class="line">$ cd grpc/examples/node/dynamic_codegen</span><br><span class="line">$ # Install the example&apos;s dependencies</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> gRPC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-01-03-SearchInsertPosition</title>
      <link href="/2020/01/03/2020-01-03-SearchInsertPosition/"/>
      <url>/2020/01/03/2020-01-03-SearchInsertPosition/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCode38"><a href="#LeetCode38" class="headerlink" title="LeetCode38"></a>LeetCode38</h1><p>Easy</p><p>Given a sorted array and a target value, return the index if the target is found. If not, return the index where it would be if it were inserted in order.</p><p>You may assume no duplicates in the array.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,3,5,6], 5</span><br><span class="line">Output: 2</span><br></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,3,5,6], 2</span><br><span class="line">Output: 1</span><br></pre></td></tr></table></figure><p><strong>Example 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,3,5,6], 7</span><br><span class="line">Output: 4</span><br></pre></td></tr></table></figure><p><strong>Example 4:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,3,5,6], 0</span><br><span class="line">Output: 0</span><br></pre></td></tr></table></figure><p>离职后的第一题想先简单点热个身（后面有个难的目前还没做出来），就是说给一个target，返回它在数组中的位置</p><h1 id="How"><a href="#How" class="headerlink" title="How"></a>How</h1><p>该题目一上脑子就可以写下如下的代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (target &gt; nums[nums.length - <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums.length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> pos =<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">         <span class="keyword">if</span>(nums[i]&lt;target &amp;&amp; nums[i+<span class="number">1</span>]&gt;=target)&#123;</span><br><span class="line">            pos = ++i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>  pos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但转念一想，题目中给定的是一个sorted array这是一个优化的切口，可以将O(n)的复杂度降低到O(logn),通过递归来拆解完成这道题</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (low+high)/<span class="number">2</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (target &lt; nums[mid]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mid == <span class="number">0</span> || target &gt; nums[mid-<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> mid;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> searchInsert(nums, target, low, mid-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (target &gt; nums[mid]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mid == nums.length-<span class="number">1</span> || target &lt; nums[mid+<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> mid+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> searchInsert(nums, target, mid+<span class="number">1</span>, high);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-12-22-zookeeper概要</title>
      <link href="/2019/12/16/2019-12-22-zookeeper%E6%A6%82%E8%A6%81/"/>
      <url>/2019/12/16/2019-12-22-zookeeper%E6%A6%82%E8%A6%81/</url>
      
        <content type="html"><![CDATA[<p>含义：动物管理员，管理节点</p><p>作用：开源的分布式应用程序协调服务（简单来说，就是一个抽象出来，专门管理各个服务的管理员，发现服务，注册服务，以实现分布式应用的联合工作）</p><p>feature</p><ul><li>树状目录结构，节点称作znode</li><li>持久节点（客户端断开仍然存在）</li><li>临时节点（断开消失）</li><li>节点监听（通过get exists,getchildren来实行监听）</li></ul><p>应用：</p><ul><li>分布式锁</li></ul><table><thead><tr><th></th><th>描述</th></tr></thead><tbody><tr><td>问题场景</td><td>我们有一个服务C，将A系统的订单数据，发送到B系统进行财务处理，但这个服务部C署了三个服务器来进行并发，其中有些数据在传送处理时会new一个objectid，如果不添加锁，该数据可能被两个服务同时调起，在B服务中生成两条记录</td></tr><tr><td>解决方案</td><td>我们同步数据时候，需要给同一个数据加锁，防止该数据同时被两个服务调起，服务访问某条订单数据时候，需要先获得锁，操作完后释放锁</td></tr><tr><td>实现方式</td><td>每个服务连接一个znode的下属有序临时节点，并监听上个节点的变化，编号最小的临时节点获得锁，操作资源，来实现</td></tr></tbody></table><ul><li>服务注册和发现</li></ul><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>问题场景</td><td>我们同步数据的服务C（上个表格中描述）,可能是部署在一个机器上的多进程，也可能是部署在多个物理ip上的服务，他是动态变化的，如果没有zookeeper类的软件，可能我每改一次ip，都需要重启一下服务，服务宕机了，也要改ip（不然404）</td></tr><tr><td>解决方案</td><td>我们需要有个服务来管理应用状态，知道服务的运行状态，这样，当其他服务调起这个服务的时候，才能通过zookeeper提供的地址进行同行</td></tr><tr><td>实现方式</td><td>服务启动会注册到zookeeper，并保持心跳，其他服务想要调用某服务的时候，询问zookeeper拿到地址，然后发送请求报文（例如RPC）</td></tr><tr><td></td><td>1.每个应用创建一个持久节点，每个服务在持久节点下建立临时节点，不同应用间会有监听，A服务如果变动，B服务会收到订阅</td></tr><tr><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> zookeeper </category>
          
      </categories>
      
      
        <tags>
            
            <tag> introduction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-12-22-SpringBoot概要</title>
      <link href="/2019/12/16/2019-12-22-SpringBoot%E6%A6%82%E8%A6%81%20/"/>
      <url>/2019/12/16/2019-12-22-SpringBoot%E6%A6%82%E8%A6%81%20/</url>
      
        <content type="html"><![CDATA[<p>含义：spring 的简化配置版本（继承父类依赖，拥有父类的所有配置）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--你的项目pom文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--点开spring-boot-starter-parent，文件相对位置\org\springframework\boot\spring-boot-starter-parent\2.0.4.RELEASE--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>&gt;</span>../../spring-boot-dependencies<span class="tag">&lt;/<span class="name">relativePath</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><p>微服务</p><p>AOP</p><p>简化部署，可以再pom.xml中配置plugins来实现导出jar包，方便执行</p><p>Features:</p><ul><li>starter</li><li>入口类标记@SpringBootApplication</li><li>SpringBoot配置类@SpringBootConfiguration</li><li>配置类@Configuration</li><li>开启自动配置@EnableAutoConfiguration</li><li>自动配置包@AutoConfigurationPackage</li><li>导入组件@Import</li></ul><p>疑惑</p><ul><li>为什么使用注解</li><li>为什么需要AOP</li><li>为什么选择springboot</li><li></li></ul>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> introduction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-12-15-@SpringBootApplication</title>
      <link href="/2019/12/15/2019-12-15-SpringBootApplication/"/>
      <url>/2019/12/15/2019-12-15-SpringBootApplication/</url>
      
        <content type="html"><![CDATA[<h1 id="启动类"><a href="#启动类" class="headerlink" title="启动类"></a>启动类</h1><p>我们可以见到最简单的springboot的application.java文件如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringTestApplication</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication.run(SpringTestApplication.class, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>实际上，SpringApplication的run方法时首先会创建一个SpringApplication类的对象，利用构造方法创建SpringApplication对象时会调用initialize方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Object source, String... args)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> run(<span class="keyword">new</span> Object[] &#123; source &#125;, args);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Object[] sources, String[] args)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> SpringApplication(sources).run(args);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(Object... sources)</span> </span>&#123;</span><br><span class="line">initialize(sources);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中initialize方法如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">`<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">(Object[] sources)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 在sources不为空时，保存配置类</span></span><br><span class="line">    <span class="keyword">if</span> (sources != <span class="keyword">null</span> &amp;&amp; sources.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.sources.addAll(Arrays.asList(sources));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 判断是否为web应用</span></span><br><span class="line">    <span class="keyword">this</span>.webEnvironment = deduceWebEnvironment();</span><br><span class="line">    <span class="comment">// 获取并保存容器初始化类，通常在web应用容器初始化使用</span></span><br><span class="line">    <span class="comment">// 利用loadFactoryNames方法从路径MEAT-INF/spring.factories中找到所有的ApplicationContextInitializer</span></span><br><span class="line">    setInitializers((Collection) getSpringFactoriesInstances(</span><br><span class="line">        ApplicationContextInitializer.class));</span><br><span class="line">    <span class="comment">// 获取并保存监听器</span></span><br><span class="line">    <span class="comment">// 利用loadFactoryNames方法从路径MEAT-INF/spring.factories中找到所有的ApplicationListener</span></span><br><span class="line">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class="line">    <span class="comment">// 从堆栈信息获取包含main方法的主配置类</span></span><br><span class="line">    <span class="keyword">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实例化后调用run：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(String... args)</span> </span>&#123;</span><br><span class="line">    StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">    stopWatch.start();</span><br><span class="line">    ConfigurableApplicationContext context = <span class="keyword">null</span>;</span><br><span class="line">    FailureAnalyzers analyzers = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// 配置属性</span></span><br><span class="line">    configureHeadlessProperty();</span><br><span class="line">    <span class="comment">// 获取监听器</span></span><br><span class="line">    <span class="comment">// 利用loadFactoryNames方法从路径MEAT-INF/spring.factories中找到所有的SpringApplicationRunListener</span></span><br><span class="line">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class="line">    <span class="comment">// 启动监听</span></span><br><span class="line">    <span class="comment">// 调用每个SpringApplicationRunListener的starting方法</span></span><br><span class="line">    listeners.starting();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 将参数封装到ApplicationArguments对象中</span></span><br><span class="line">        ApplicationArguments applicationArguments = <span class="keyword">new</span> DefaultApplicationArguments(</span><br><span class="line">            args);</span><br><span class="line">        <span class="comment">// 准备环境</span></span><br><span class="line">        <span class="comment">// 触发监听事件——调用每个SpringApplicationRunListener的environmentPrepared方法</span></span><br><span class="line">        ConfigurableEnvironment environment = prepareEnvironment(listeners,</span><br><span class="line">            applicationArguments);</span><br><span class="line">        <span class="comment">// 从环境中取出Banner并打印</span></span><br><span class="line">        Banner printedBanner = printBanner(environment);</span><br><span class="line">        <span class="comment">// 依据是否为web环境创建web容器或者普通的IOC容器</span></span><br><span class="line">        context = createApplicationContext();</span><br><span class="line">        analyzers = <span class="keyword">new</span> FailureAnalyzers(context);</span><br><span class="line">        <span class="comment">// 准备上下文</span></span><br><span class="line">        <span class="comment">// 1.将environment保存到容器中</span></span><br><span class="line">        <span class="comment">// 2.触发监听事件——调用每个SpringApplicationRunListeners的contextPrepared方法</span></span><br><span class="line">        <span class="comment">// 3.调用ConfigurableListableBeanFactory的registerSingleton方法向容器中注入applicationArguments与printedBanner</span></span><br><span class="line">        <span class="comment">// 4.触发监听事件——调用每个SpringApplicationRunListeners的contextLoaded方法</span></span><br><span class="line">        prepareContext(context, environment, listeners, applicationArguments,</span><br><span class="line">            printedBanner);</span><br><span class="line">        <span class="comment">// 刷新容器，完成组件的扫描，创建，加载等</span></span><br><span class="line">        refreshContext(context);</span><br><span class="line">        afterRefresh(context, applicationArguments);</span><br><span class="line">        <span class="comment">// 触发监听事件——调用每个SpringApplicationRunListener的finished方法</span></span><br><span class="line">        listeners.finished(context, <span class="keyword">null</span>);</span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) &#123;</span><br><span class="line">            <span class="keyword">new</span> StartupInfoLogger(<span class="keyword">this</span>.mainApplicationClass)</span><br><span class="line">                .logStarted(getApplicationLog(), stopWatch);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 返回容器</span></span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        handleRunFailure(context, listeners, analyzers, ex);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了建立调用逻辑画了一张图，比较粗糙</p><p><img src="..\img\springbootApplication.png" alt=""></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>SpringApplication.run一共做了两件事</p><ul><li>创建SpringApplication对象；在对象初始化时保存事件监听器，容器初始化类以及判断是否为web应用，保存包含main方法的主配置类。</li><li>调用run方法；准备spring的上下文，完成容器的初始化，创建，加载等。会在不同的时机触发监听器的不同事件</li></ul><p><a href="https://www.cnblogs.com/davidwang456/p/5846513.html" target="_blank" rel="noopener">https://www.cnblogs.com/davidwang456/p/5846513.html</a></p>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> annotation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-12-14-分布式系统</title>
      <link href="/2019/12/14/2019-12-14-%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
      <url>/2019/12/14/2019-12-14-%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h1><p>原因：<br>目的：</p><h2 id="数据库唯一索引"><a href="#数据库唯一索引" class="headerlink" title="数据库唯一索引"></a>数据库唯一索引</h2><h2 id="redis-的SETNX"><a href="#redis-的SETNX" class="headerlink" title="redis 的SETNX"></a>redis 的SETNX</h2><h2 id="redis的RedLock"><a href="#redis的RedLock" class="headerlink" title="redis的RedLock"></a>redis的RedLock</h2><h1 id="分布式事务"><a href="#分布式事务" class="headerlink" title="分布式事务"></a>分布式事务</h1><h1 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h1><h1 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h1><h1 id="Paxos"><a href="#Paxos" class="headerlink" title="Paxos"></a>Paxos</h1><h1 id="Raft"><a href="#Raft" class="headerlink" title="Raft"></a>Raft</h1>]]></content>
      
      
      <categories>
          
          <category> Distribution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> KnowageTree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-10-27-DynamicProgramming动态规划</title>
      <link href="/2019/10/27/2019-10-27-DynamicProgramming%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
      <url>/2019/10/27/2019-10-27-DynamicProgramming%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>动态规划是通过组合子问题的解里求解原问题，一般被用来求最优化问题</p><ul><li>1.刻画一个最优解的结构特征</li><li>2.递归定义最优解的值</li><li>3.计算最优解</li><li>4.计算的信息构造最优解</li></ul>]]></content>
      
      
      <categories>
          
          <category> Algorithms </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DynamicProgramming </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-09-21-中台是什么</title>
      <link href="/2019/09/21/2019-09-21-%E4%B8%AD%E5%8F%B0%E6%98%AF%E4%BB%80%E4%B9%88/"/>
      <url>/2019/09/21/2019-09-21-%E4%B8%AD%E5%8F%B0%E6%98%AF%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>公司最近上了一套中台服务，因为好奇所以查了一下资料，中台是为了提高开发效率，将各个服务中共同的组织，资源集中管理，作为一个整体服务，宏观上我们可以把淘宝客户端，盒马生鲜，饿了么看做大前端，而他们有一部分共享数据，比如用户信息，支付功能，搜索功能等</p><p><img src="..\img\alibaba.jpg" alt=""></p><p>又比如我们公司的电商平台，核心系统包括，ERP（企业资源计划即 <em>ERP</em> Ent<em>erp</em>rise Resource Planning），WMS（仓库管理系统Warehouse Management System）以及一套交付系统（包含购买，安装服务，维修服务，代理商管理等），他们需要共享商品信息，ERP需要用来算账，WMS需要用来发货，交付系统需要用来记录他的生命周期，就在中台配置一套信息，就可以达到三套系统都可以访问的效果。</p><h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>中台也可以分类：</p><ul><li>业务中台（如上举例我们公司的业务）</li><li>技术中台（如淘宝的中台，当然也有偏业务的部分，主要目的防止重复造轮子）</li><li>数据中台（包括建模，日志分析，profile）</li><li>算法中台（推荐算法，搜索算法等）</li></ul><h1 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h1><p>目前中台还是比较烧钱的吧，公司没有到达一定的规模，这个东西还是没有什么卵用，我们目前上了一套ERP，一套中台，级别在千万吧，还需要各个部门进行配合，进行系统整合（以前都是各干各的，系统间几乎没有交互，重复造轮子）。恶心的我啊，加了10117了三个月才大体上能用了</p><p>不过我觉得中台的发展历史可能和服务一样，一个整体的服务臃肿，后续的中台还是会变成中心化，即一个核心业务，其他做成微服务，分布式的架构，是目前技术潮流的前进方向</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-09-14Node日志感受</title>
      <link href="/2019/09/14/2019-09-14-Node%E6%97%A5%E5%BF%97%E6%84%9F%E5%8F%97/"/>
      <url>/2019/09/14/2019-09-14-Node%E6%97%A5%E5%BF%97%E6%84%9F%E5%8F%97/</url>
      
        <content type="html"><![CDATA[<h1 id="why"><a href="#why" class="headerlink" title="why"></a>why</h1><p>日志是用来记录程序运行重要的工具</p><ul><li>记录请求日志，关键节点打上日志，可以追踪问题（<strong>生产</strong>）</li><li>方便调试，定位故障</li><li>监控应用的运行状态</li></ul><h1 id="what-egg-js为例"><a href="#what-egg-js为例" class="headerlink" title="what(egg.js为例)"></a>what(egg.js为例)</h1><p>日志分为：</p><ul><li>appLogger应用日志，也是我们自定义的日志</li><li>coreLogger核心框架，插件日志</li><li>errorLogger</li><li>agentLogger用于监控agent日志</li></ul><p>日志级别：</p><ul><li>ctx.logger.debug()</li><li>ctx.logger.info()</li><li>ctx.logger.warn()</li><li>ctx.logger.error()</li><li>以appLogger为例，一共4*4种</li></ul><p>日志编码：</p><ul><li>默认utf-8</li></ul><h1 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h1><p>目前日志都支持切割，每天一个文件，以.log.2019-09-14为尾缀（小时切割和文件大小切割实用性不高），编写日志的时候我们也需要注意如下几点：</p><ul><li><p>在关键请求关键位置打好日志</p></li><li><p>打印日志注明这是哪个文件哪个方法处理的日志</p><ul><li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">logger.debug(<span class="string">`&gt;&gt;&gt;&gt; Entering yourMethod(month = <span class="subst">$&#123;month&#125;</span>, count= <span class="subst">$&#123;count&#125;</span>");</span></span><br><span class="line"><span class="string">//通过日志 &gt;&gt;&gt;&gt; 和 &lt;&lt;&lt;&lt; 将给出函数输入和退出的信息</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>日志不能太多，一个是查问题日志太多，第二个是对硬盘写入日志也有一定性能影响（egg是写入内存，每秒保存一次硬盘）</p></li><li><p>合理使用try-catch来进行日志输出</p></li><li><p>日志写法一定要避免简洁，不要日志再抛错（正常打印参数，打印处理结果）</p></li><li><p>日志不能具备除了日志以外的功能</p></li><li><p>正确把握日志级别，info记录信息（最主要的），debug显示调试信息，warn显示警告，error保存数据库请求类型的报错</p></li><li><p>尽量使用ctx.logger而并非console.log，后者将会把所有日志打印在stdout中，无法关闭或打开调试信息，并且不区分级别</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Node </category>
          
      </categories>
      
      
        <tags>
            
            <tag> logs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-04-24-Nodejs12</title>
      <link href="/2019/04/24/2019-04-24-Nodejs12/"/>
      <url>/2019/04/24/2019-04-24-Nodejs12/</url>
      
        <content type="html"><![CDATA[<h1 id="Introducing-Node-js-12"><a href="#Introducing-Node-js-12" class="headerlink" title="Introducing Node.js 12"></a><strong>Introducing Node.js 12</strong></h1><p><a href="https://medium.com/@nodejs/introducing-node-js-12-76c41a1b3f3f" target="_blank" rel="noopener">raw article</a></p><p>Apr 24</p><p><em>This blog was written by Bethany Griggs and Michael Dawson, with additional contributions from the Node.js Release Team and Technical Steering committee.</em></p><p>We are excited to announce Node.js 12 today. Highlighted updates and features include faster startup and better default heap limits, updates to V8, TLS, llhttp, new features including diagnostic report, bundled heap dump capability and updates to Worker Threads, N-API and ES6 module support and more. The Node.js 12 release replaces version 11 in our current release line. The Node.js release line will become a Node.js Long Term Support (LTS) release in Oct 2019 (more details on <a href="https://github.com/nodejs/release" target="_blank" rel="noopener">LTS strategy here</a>).</p><p><strong>V8 Gets an Upgrade: V8 update to V8 7.4</strong>As always a new version of the V8 JavaScript engine brings performance tweaks and improvements as well as keeping Node.js up with the ongoing improvements in the language and runtime. Highlights include:</p><ul><li>Async stack traces: <a href="https://v8.dev/blog/v8-release-72#async-stack-traces" target="_blank" rel="noopener">https://v8.dev/blog/v8-release-72#async-stack-traces</a></li><li>Faster calls with arguments mismatch: <a href="https://v8.dev/blog/v8-release-74#faster-calls-with-arguments-mismatch" target="_blank" rel="noopener">https://v8.dev/blog/v8-release-74#faster-calls-with-arguments-mismatch</a></li><li>Faster await: <a href="https://v8.dev/blog/v8-release-73#faster-await" target="_blank" rel="noopener">https://v8.dev/blog/v8-release-73#faster-await</a></li><li>Faster javascript parsing: <a href="https://v8.dev/blog/v8-release-72#javascript-parsing" target="_blank" rel="noopener">https://v8.dev/blog/v8-release-72#javascript-parsing</a></li></ul><p>Read more about V8 at their <a href="https://v8.dev/blog" target="_blank" rel="noopener">official blog</a>.</p><p><strong>Hello TLS 1.3</strong></p><p>Node.js 12 is introducing TLS1.3 support and making it the default max protocol, while also supporting CLI/NODE_OPTIONS switches to disable it if necessary.</p><p>TLS1.3 is a major update to the TLS protocol, with many security enhancements and should be used over TLS1.2 whenever possible.</p><p>TLS1.3 is different enough that even though the OpenSSL APIs are technically API/ABI compatible when TLS1.3 is negotiated, changes in the timing of protocol records and of callbacks broke assumptions hard-coded into the ‘tls’ module. This change introduces no API incompatibilities when TLS1.2 is negotiated. It is the intention that it be backported to current and LTS release lines with the default maximum TLS protocol reset to ‘TLSv1.2’. This will allow users of those lines to explicitly enable TLS1.3 if they want. If you want to read more you can check out these related articles:<a href="https://developer.ibm.com/blogs/openssl-111-has-landed-in-nodejs-master-and-why-its-important-for-nodejs-lts-releases/" target="_blank" rel="noopener">https://developer.ibm.com/blogs/openssl-111-has-landed-in-nodejs-master-and-why-its-important-for-nodejs-lts-releases/</a>, <a href="https://developer.ibm.com/blogs/tls13-is-coming-to-nodejs/" target="_blank" rel="noopener">https://developer.ibm.com/blogs/tls13-is-coming-to-nodejs/</a></p><p><strong>Properly configure default heap limits</strong>This update will configure the JavaScript heap size based on available memory instead of using defaults that were set by V8 for use with browsers. In previous releases, unless configured, V8 defaulted to limiting the max heap size to 700 MB or 1400MB on 32 and 64-bit platforms respectively. Configuring the heap size based on available memory ensures that Node.js does not try to use more memory than is available and terminating when its memory is exhausted.</p><p>This is particularly useful when processing large data-sets. As before, it will still be possible to set — max-old-space-size to use a different limit if the default is not appropriate for your application.</p><p><strong>Switch default http parser to llhttp</strong><br>Node.js 12 will also switch the default parser to llhttp. This will be beneficial in that it will make testing and comparing the new llhttp-based implementation easier. First introduced as<a href="https://github.com/nodejs/node/pull/24059" target="_blank" rel="noopener"> llhttp experimental</a> in v11.2.0, <a href="https://github.com/indutny/llhttp" target="_blank" rel="noopener">llhttp</a> will be taken out of experimental in this release.</p><p><strong>Making Native Modules Easier — progress continues</strong>Node.js 12 continues the trend of making building and supporting native modules easier. Changes include better support for native modules in combination with Worker threads, as well as N-API (<a href="https://nodejs.org/api/n-api.html#n_api_n_api" target="_blank" rel="noopener">https://nodejs.org/api/n-api.html#n_api_n_api</a>) version 4 (which has also been backported to 8.x and 10.x) which makes it easier to use your own threads for native asynchronous functions. You can read more about this and how you can leverage it in your modules in this great article here: <a href="https://medium.com/the-node-js-collection/new-features-bring-native-add-ons-close-to-being-on-par-with-js-modules-cd4f9b8e4b4" target="_blank" rel="noopener">https://medium.com/the-node-js-collection/new-features-bring-native-add-ons-close-to-being-on-par-with-js-modules-cd4f9b8e4b4</a></p><p><strong>Worker Threads</strong>Worker Threads (<a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener">https://nodejs.org/api/worker_threads.html</a>), while not new in this release, are still seeing progress. The use of Workers Threads no longer requires the use of a flag and they are progressing well towards moving out of experimental. While Node.js already performs well with the single-threaded event loop, there are some use-cases where additional threads can be leveraged for better results. We’d like you to try them out and let us know what use cases you have where they are helpful. For a quick introduction check out this great article: <a href="https://medium.com/@Trott/using-worker-threads-in-node-js-80494136dbb6" target="_blank" rel="noopener">https://medium.com/@Trott/using-worker-threads-in-node-js-80494136dbb6</a>.</p><p><strong>Diagnostic Reports</strong>Node.js 12 brings with it a new experimental feature “Diagnostic report.” This allows you to generate a report on demand or when certain events occur. This report contains information that can be useful to help diagnose problems in production including crashes, slow performance, memory leaks, high CPU usage, unexpected errors and more. You can read more about it in this great article: <a href="https://medium.com/the-node-js-collection/easily-identify-problems-in-node-js-applications-with-diagnostic-report-dc82370d8029" target="_blank" rel="noopener">https://medium.com/the-node-js-collection/easily-identify-problems-in-node-js-applications-with-diagnostic-report-dc82370d8029</a>.</p><p><strong>Heap Dumps</strong>If you ever needed to generate heap dumps in order to investigate memory issues but were slowed down by having to install a new module into production, the good news is that Node.js 12 brings integrated heap dump capability out of the box. You can check out the documentation in <a href="https://github.com/nodejs/node/pull/27133" target="_blank" rel="noopener">https://github.com/nodejs/node/pull/27133</a> and <a href="https://github.com/nodejs/node/pull/26501" target="_blank" rel="noopener">https://github.com/nodejs/node/pull/26501</a> to learn more.</p><p><strong>Startup Improvements</strong>In Node.js 11 we shipped built-in code cache support in workers — when loading built-in libraries written in JavaScript, if the library was previously compiled on the main thread, the worker thread no longer needs to compile it from scratch but can reuse the <a href="https://v8.dev/blog/code-caching" target="_blank" rel="noopener">v8 code cache</a> generated by the main thread to speed up compilation. Similarly, the main thread can reuse the cache generated by workers. This gave a <a href="https://github.com/nodejs/node/pull/24950" target="_blank" rel="noopener">roughly 60% speedup</a> for the startup of workers.</p><p>Now in Node.js 12 we <a href="https://github.com/nodejs/node/pull/27161" target="_blank" rel="noopener">generate the code cache for built-in libraries in advance at build time</a>, and embed it in the binary, so in the final release, the main thread can use the code cache to start up the initial load of any built-in library written in JavaScript. This gives a ~30% speedup in startup time for the main thread.</p><p><strong>ES6 Module Support</strong>Node.js 12 brings an updated experimental version of support for ES6 modules. It is an important step toward a supported implementation and we’d like you to try it out and give us feedback. For more details check out this <a href="https://medium.com/@nodejs/announcing-a-new-experimental-modules-1be8d2d6c2ff" target="_blank" rel="noopener">great blog post</a>.</p><p><strong>New compiler and platform minimums</strong>Node.js and V8 continue to embrace newer C++ features and take advantage of newer compiler optimizations and security enhancements. With the release of Node.js 12, the codebase now requires a minimum of GCC 6 and glibc 2.17 on platforms other than macOS and Windows. Binaries released at Node.js org use this new toolchain minimum and therefore include new compile-time performance and security enhancements.</p><p>The increment in minimum compiler and libc requirements also increments minimums in supported platforms. Platforms using glibc (most platforms other than macOS and Windows) must now include a minimum version of 2.17. Common Linux platforms compatible with this version include Enterprise Linux 7 (RHEL and CentOS), Debian 8 and Ubuntu 14.04. Binaries available from nodejs.org will be compatible with these systems. Users needing to compile their own binaries on systems not natively supporting GCC 6 may need to use a custom toolchain. Even though Node.js 12.0.0 may compile with older compilers, expect the Node.js 12 codebase (including V8) to rapidly adopt C++ features supported by GCC 6 during the pre-LTS timeframe.</p><p>Windows minimums remain the same as Node.js 11, requiring at least Windows 7, 2008 R2 or 2012 R2 and a minimum compiler of Visual Studio 2017. macOS users needing to compile Node.js will require a minimum of Xcode 8 and Node.js binaries made available on nodejs.org will only support a minimum of macOS 10.10 “Yosemite”.</p><p>Further details are available in the Node.js <a href="https://github.com/nodejs/node/blob/v12.x/BUILDING.md#platform-list" target="_blank" rel="noopener">BUILDING.md</a>.</p><p><strong>Thank you!</strong>A big thank you to everyone who made this release come together, whether you submitted a pull request, helped with our benchmarking efforts, or you were in charge of one of the release versions. We’d also like to thank t<a href="https://github.com/nodejs/build" target="_blank" rel="noopener">he Node.js Build Working Group</a> for ensuring we have the infrastructure to create and test releases. The release manager for Node.js 12 is <a href="https://github.com/BethGriggs" target="_blank" rel="noopener">Bethany Griggs</a>. For a full list of the release team members head <a href="https://github.com/nodejs/release#releasers-team" target="_blank" rel="noopener">here</a>. You can read more about the complete list of features <a href="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V12.md" target="_blank" rel="noopener">here</a>.</p><p>If you are interested in contributing to Node.js, we welcome you. Learn more via our contributor <a href="https://github.com/nodejs/node/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener">guidelines</a>.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-04-20-rentingHouse</title>
      <link href="/2019/04/20/2019-04-20-rentingHouse/"/>
      <url>/2019/04/20/2019-04-20-rentingHouse/</url>
      
        <content type="html"><![CDATA[<p>快要毕业了，朋友圈里洋溢着，毕业的快乐，直系学弟们也返校进行了毕业论文的最终答辩，也希望他们都取得一个好的成绩，能在回首大学四年时候，<strong>不因为碌碌无为而后悔</strong>，能够在社一中，找到一份合适的工作，并感谢曾经那个在大学奋斗的自己。</p><p><img src="../img/毕业.jpg" alt=""></p><p>毕业季第一道坎就是租房（家里有矿的，这篇文章你就可以关掉了），总体来说，在京就业，房租确实很贵的，不过对于计算机专业来说，应该还是可以的。我们熟知的计算机区域</p><ul><li>望京SOHO（小企业居多）</li><li>中关村</li><li><strong>中关村软件园</strong>（大厂）</li></ul><p>对应的租房地点可以选择：</p><ul><li>孙河（就可能地铁站远一点）</li><li>上地附近</li><li>回龙观，朱辛庄</li></ul><p>主要平台（按推荐顺序）：</p><ul><li>自如（个人选择项，应届生有特权）</li><li>豆瓣小组</li><li>闲鱼</li><li>相如&gt;蛋壳=贝壳</li></ul><p>应届生可能囊中羞涩，所以建议选择自如，分期月付（应届免押金，分起费120附近），不过计算机专业的应届生薪资理论上是&gt;=7k，所以我觉得应该马马虎虎可以生存下来了。之所以不推荐其他的中介，是因为你可能租房后，对于维修，舍友抽烟，养的宠物半夜狂叫，又退不了租，陷入麻烦中。（自如麻烦来结一下广告费）</p><p>另外整理一下招聘的软件（按推荐顺序）：</p><ul><li><p>（个人软件工程，仅供参考）</p></li><li><p>BOSS</p></li><li>拉钩</li><li>智联招聘</li><li>脉脉</li></ul><p>希望这些资料对刚毕业的你有所帮助，其余想起来的，再直接更新</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2019-04-17-日记</title>
      <link href="/2019/04/17/2019-04-17-%E6%97%A5%E8%AE%B0/"/>
      <url>/2019/04/17/2019-04-17-%E6%97%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>经历了连续9*13小时的工作后，我终于得到了一天的调休计划，昨晚十一点半打车从五棵松到家</p><p><img src="../img/发票.jpg" alt=""></p><p>洗了个热水澡，关了手机闹铃，打开了Alexa的环境噪音，难的踏实的进入了梦中。</p><p>但是！！</p><p>我Alexa的闹钟忘记关了，七点被吵醒后一直没有睡着，所以起床热了杯牛奶，弄了张煎饼，涂了点番茄酱就凑合吃了，后来外出和朋友聊了会儿天，倒确实点出了一些目前存在的问题</p><ul><li>一个好的技术不仅要知其然，更要知其所以然，多挖掘他背后的源码，去思考如何实现，这样才能在高并发时，将200ms优化到100ms，才是一个高级程序员应该具备的素质之一</li><li>Node学习分为三年，第一年知其语法，会写应用，第二年知其框架，高级开发，第三年，读其源码，知其原理</li><li>多用语言去写一些工具类，多去学习和参考优质轮子，而不是写一些玩具，别人都写烂的东西</li><li>（重要的应该就这么多了）</li></ul><p>朋友的话很对，我也进行了思考，自己在JS的道路上，摸着黑走路，对于源码其实要读，但是之前打开看过一眼就一脸懵逼的状态，所以还是需要有时间学习一下优质的GitHub，撕开一个口子，然后进入到正轨，自己去多写一些方法区调用，然后一点点去琢磨，他的实现过程。</p><p><img src="../img/purjoy.jpg" alt=""></p><p>4月底的计划就是</p><ul><li>尽量换一份工作，受不了8117，薪资还不如麦当劳的临时工</li><li>自如租约到期了，搬家到朱辛庄或者霍营</li><li>没换工作的话，买一本书通勤看会儿，换工作的话，抽个零碎的时间读，顺便整理笔记，更博（暂定这个月读一下v8的gc）</li><li>五一出去旅游，暂时想去杭州看看</li><li>买点竹筒，想做竹筒饭</li></ul>]]></content>
      
      
      <categories>
          
          <category> life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> diary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>暂停更新通告[作废]</title>
      <link href="/2019/04/13/2019-04-13-%E6%9A%82%E5%81%9C%E6%9B%B4%E6%96%B0%E9%80%9A%E5%91%8A/"/>
      <url>/2019/04/13/2019-04-13-%E6%9A%82%E5%81%9C%E6%9B%B4%E6%96%B0%E9%80%9A%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<p>自今日起，博客开始停更</p><h1 id="996-icu"><a href="#996-icu" class="headerlink" title="996.icu"></a>996.icu</h1><p>年后开始，互联网似乎过得都不好，从七陌被裁（也有个人原因吧），到被航天二院，知网，中电科因为学历卡住入职（BOSS直聘，面试完了，技术找人事审核不通过），后来遇到了一系列傲慢的中科软系列面试，无限加班的创业公司，还有那种以培训机构为目标招人的小公司。最终未能收获一个满意的offer，最终舔狗选择了一家说是不加班的某所，然，现在才发现，实在太忙，包括现在也刚刚到家，工作也没有pc，没有网络，所以也很不方便随时学习，可能有一些手写笔记，但经历有限，所以最近会停止更新</p><p>年后996冲上了榜首，让世界都在反思为什么中国的加班为什么如此疯狂，但话题热度很快下降，因为没有人会去放下手中的工作去抵制，毕竟生活总要继续下去</p><p>生活总是这样，起起落落落</p><p>努力不一定有回报，但不努力一定很（mei）舒（hui）服(bao)</p><p>晚安~hexo</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PermutationSequence-60</title>
      <link href="/2019/04/09/2019-04-09-PermutationSequence/"/>
      <url>/2019/04/09/2019-04-09-PermutationSequence/</url>
      
        <content type="html"><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><p>The set <code>[1,2,3,...,*n*]</code> contains a total of <em>n</em>! unique permutations.</p><p>By listing and labeling all of the permutations in order, we get the following sequence for <em>n</em> = 3:</p><ol><li><code>&quot;123&quot;</code></li><li><code>&quot;132&quot;</code></li><li><code>&quot;213&quot;</code></li><li><code>&quot;231&quot;</code></li><li><code>&quot;312&quot;</code></li><li><code>&quot;321&quot;</code></li></ol><p>Given <em>n</em> and <em>k</em>, return the <em>k</em>th permutation sequence.</p><p><strong>Note:</strong></p><ul><li>Given <em>n</em> will be between 1 and 9 inclusive.</li><li>Given <em>k</em> will be between 1 and <em>n</em>! inclusive.</li></ul><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: n = 3, k = 3</span><br><span class="line">Output: &quot;213&quot;</span><br></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: n = 4, k = 9</span><br><span class="line">Output: &quot;2314&quot;</span><br></pre></td></tr></table></figure><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>https与http</title>
      <link href="/2019/04/06/2019-04-06-https%E4%B8%8Ehttp/"/>
      <url>/2019/04/06/2019-04-06-https%E4%B8%8Ehttp/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><h1 id="advantage"><a href="#advantage" class="headerlink" title="advantage"></a>advantage</h1><p>客户端在使用HTTPS方式与Web服务器通信时有以下几个步骤，如图所示。</p><p>　　（1）客户使用https的URL访问Web服务器，要求与Web服务器建立SSL连接。</p><p>　　（2）Web服务器收到客户端请求后，会将网站的证书信息（证书中包含公钥）传送一份给客户端。</p><p>　　（3）客户端的浏览器与Web服务器开始协商SSL连接的安全等级，也就是信息加密的等级。</p><p>　　（4）客户端的浏览器根据双方同意的安全等级，建立会话密钥，然后利用网站的公钥将会话密钥加密，并传送给网站。</p><p>　　（5）Web服务器利用自己的私钥解密出会话密钥。</p><p>　　（6）Web服务器利用会话密钥加密与客户端之间的通信。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SpiralMatrix2-59</title>
      <link href="/2019/04/06/2019-04-06-SpiralMatrix2/"/>
      <url>/2019/04/06/2019-04-06-SpiralMatrix2/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>Given a positive integer <em>n</em>, generate a square matrix filled with elements from 1 to <em>n</em>2 in spiral order.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: 3</span><br><span class="line">&gt;Output:</span><br><span class="line">&gt;[</span><br><span class="line">&gt; [ 1, 2, 3 ],</span><br><span class="line">&gt; [ 8, 9, 4 ],</span><br><span class="line">&gt; [ 7, 6, 5 ]</span><br><span class="line">&gt;]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>虽然标了medium，但是确实很简单，形成一个口字型闭环，一层层去处理就好了，然后再主要就是控制口字循环时候的边界，以及最后一个元素的判断</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public int[][] generateMatrix(int n) &#123;</span><br><span class="line">int [][]res = new int[n][n];</span><br><span class="line">        int left = 0;</span><br><span class="line">        int right = n-1;</span><br><span class="line">        int top = 0;</span><br><span class="line">        int bottom = n-1;</span><br><span class="line">        int index = 1;</span><br><span class="line">        int quit = n*n;</span><br><span class="line">        while(index&lt;=quit)&#123;</span><br><span class="line">            for(int i=left;i&lt;=right;i++) &#123;</span><br><span class="line">            res[top][i] = (index++);</span><br><span class="line">            &#125;</span><br><span class="line">            top++;</span><br><span class="line">            for(int i=top;i&lt;=bottom;i++)&#123;</span><br><span class="line">            res[i][right] = (index++);</span><br><span class="line">                &#125;</span><br><span class="line">            right--;</span><br><span class="line">            for(int i=right;i&gt;=left;i--) &#123;</span><br><span class="line">                res[bottom][i]=(index++);</span><br><span class="line">            &#125;</span><br><span class="line">            bottom--;</span><br><span class="line">            for(int i=bottom;i&gt;=top;i--) &#123;</span><br><span class="line">            res[i][left]=(index++);</span><br><span class="line">            &#125;</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">        return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><p>no</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LengthofLastWord</title>
      <link href="/2019/04/06/2019-04-06-LengthofLastWord/"/>
      <url>/2019/04/06/2019-04-06-LengthofLastWord/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>Given a string <em>s</em> consists of upper/lower-case alphabets and empty space characters <code>&#39; &#39;</code>, return the length of last word in the string.</p><p>If the last word does not exist, return 0.</p><p><strong>Note:</strong> A word is defined as a character sequence consists of non-space characters only.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: &quot;Hello World&quot;</span><br><span class="line">&gt; Output: 5</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>该方法调用了java的String.split(regex)所以在复杂度上回很高，大概仅仅beat了6%的玩家，但解决很快，正确的算法思维就倒序遍历，最后开始查往前，最后一个非空格查到空格结束</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//7ms</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLastWord</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(s.length()&lt;=<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">String[] tmp = s.split(<span class="string">"\\s"</span>);</span><br><span class="line"><span class="keyword">int</span> lastIndex = tmp.length-<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(lastIndex&lt;<span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> tmp[lastIndex].length();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int lengthOfLastWord(String s) &#123;</span><br><span class="line">        int n = s.length() - 1;</span><br><span class="line">        int length = 0;</span><br><span class="line">        for(int i = n; i &gt;= 0; i--) &#123;</span><br><span class="line">            if(length == 0) &#123;</span><br><span class="line">                if(s.charAt(i) == &apos; &apos;) &#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    length++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                if(s.charAt(i) == &apos; &apos;) &#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                else &#123;</span><br><span class="line">                    length++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>eventLoop</title>
      <link href="/2019/04/04/2019-04-04-eventLoop/"/>
      <url>/2019/04/04/2019-04-04-eventLoop/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>Event Loop是一个程序结构，用于等待和发送消息和事件</p><p>a programming construct that waits for and dispatches events or messages in a program.</p><p>简单说，就是在程序中设置两个线程：一个负责程序本身的运行，称为”主线程”；另一个负责主线程与其他进程（主要是各种I/O操作）的通信，被称为”Event Loop线程”（可以译为”消息线程”）。</p><p><img src="..\img\eventloop.png" alt=""></p><p>由上图可以清楚知道Node的<strong>单线程</strong>指的是主线程为单线程</p><h1 id="异步执行"><a href="#异步执行" class="headerlink" title="异步执行"></a>异步执行</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// test.js</span><br><span class="line">setTimeout(() =&gt; console.log(1));</span><br><span class="line">setImmediate(() =&gt; console.log(2));</span><br><span class="line">process.nextTick(() =&gt; console.log(3));//异步最快</span><br><span class="line">Promise.resolve().then(() =&gt; console.log(4));</span><br><span class="line">(() =&gt; console.log(5))();//同步任务最早执行</span><br><span class="line">//53412</span><br></pre></td></tr></table></figure><p>异步分为两种：</p><ul><li>本轮循环：process.nextTick(),Promise</li><li>次轮循环:setTimeout(),setInterval,setImmediate</li></ul><p><img src="..\img\nodeTimer.png" alt=""></p><p>每一次循环中，setTimeout等次轮循环在timers阶段执行，而本轮循环就在check阶段执行，所以会先展示</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>春节12响</title>
      <link href="/2019/04/04/2019-04-04-%E6%98%A5%E8%8A%8212%E5%93%8D/"/>
      <url>/2019/04/04/2019-04-04-%E6%98%A5%E8%8A%8212%E5%93%8D/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// File: twelve_biubiu.c</span><br><span class="line">// Permission: CN-2082-2</span><br><span class="line">// Author: Li.YiYi</span><br><span class="line">// Dept: PE-362, UG</span><br><span class="line">// Origin: TI-352132</span><br><span class="line">// 春节十二响 biu biu biu!</span><br><span class="line"></span><br><span class="line">#env &quot;planet_engine&quot;</span><br><span class="line"></span><br><span class="line">int init() &#123;</span><br><span class="line">    set_engine_number_mask(ENGINE_ALL);</span><br><span class="line">    set_funeral_level(FUNERAL_FULL);</span><br><span class="line">    // 允许误差10秒以内</span><br><span class="line">    if (unix_time() &lt; make_unix_time(2082, 1, 28, 23, 59, 60-10)) return ERR_ENGIN_ENV;</span><br><span class="line">    return engine_check_init(); // after compile and before real run</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    set_curve(CURVE_NATURAL); // 自然曲线耗费燃料最少</span><br><span class="line">    for (int i :range(0, 12, 1)) &#123;</span><br><span class="line">        engine_start();</span><br><span class="line">        wait_engine(ENGINE_STATE_CHAGNE);</span><br><span class="line">        sleep(2000);</span><br><span class="line">        engin_stop();</span><br><span class="line">        wait_engine(ENGINE_STATE_CHAGNE);</span><br><span class="line">        sleep(4000); // 这个时长在模拟器里听起来更像心跳</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">int final() &#123;</span><br><span class="line">    engine_ensure_shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> life </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>各种Java中锁</title>
      <link href="/2019/04/04/2019-04-04-%E5%90%84%E7%A7%8DJava%E4%B8%AD%E9%94%81/"/>
      <url>/2019/04/04/2019-04-04-%E5%90%84%E7%A7%8DJava%E4%B8%AD%E9%94%81/</url>
      
        <content type="html"><![CDATA[<h1 id="悲观锁：先锁后用"><a href="#悲观锁：先锁后用" class="headerlink" title="悲观锁：先锁后用"></a>悲观锁：先锁后用</h1><p>每次读数据都悲观认为会被其他操作修改，应用于synchroized , ReentrantLock，因为悲观所以开销大，会阻塞其他线程</p><h1 id="乐观锁：先用后判断"><a href="#乐观锁：先用后判断" class="headerlink" title="乐观锁：先用后判断"></a>乐观锁：先用后判断</h1><p>每次读数据乐观认为没有被其他操作修改，应用于java.util.concurrent.atomic,使用版本号和CAS算法实现</p><p><strong>适用于多读的应用类型，提高吞吐量</strong></p><h1 id="公平锁：多个线程按申请所顺序取锁"><a href="#公平锁：多个线程按申请所顺序取锁" class="headerlink" title="公平锁：多个线程按申请所顺序取锁"></a>公平锁：多个线程按申请所顺序取锁</h1><p>无</p><h1 id="非公平锁"><a href="#非公平锁" class="headerlink" title="非公平锁"></a>非公平锁</h1><p>多个线程不按申请顺序取锁，提高吞吐量</p><h1 id="可入锁"><a href="#可入锁" class="headerlink" title="可入锁"></a>可入锁</h1><p>外层使用锁后，内层仍可以使用，而且不会死锁</p><h1 id="不可重入锁"><a href="#不可重入锁" class="headerlink" title="不可重入锁"></a>不可重入锁</h1><h1 id="独享锁"><a href="#独享锁" class="headerlink" title="独享锁"></a>独享锁</h1><h1 id="共享锁"><a href="#共享锁" class="headerlink" title="共享锁"></a>共享锁</h1><p>互斥锁</p><p>读写锁</p><p>分段锁</p><p>偏向锁</p><p>轻量级锁</p><p>重量级锁</p><p>自旋锁</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> lock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MinStack</title>
      <link href="/2019/03/24/2019-03-24-MinStack/"/>
      <url>/2019/03/24/2019-03-24-MinStack/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>Design a stack that supports push, pop, top, and retrieving the minimum element in constant time.</p><ul><li>push(x) – Push element x onto stack.</li><li>pop() – Removes the element on top of the stack.</li><li>top() – Get the top element.</li><li>getMin() – Retrieve the minimum element in the stack.</li></ul><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; MinStack minStack = new MinStack();</span><br><span class="line">&gt; minStack.push(-2);</span><br><span class="line">&gt; minStack.push(0);</span><br><span class="line">&gt; minStack.push(-3);</span><br><span class="line">&gt; minStack.getMin();   --&gt; Returns -3.</span><br><span class="line">&gt; minStack.pop();</span><br><span class="line">&gt; minStack.top();      --&gt; Returns 0.</span><br><span class="line">&gt; minStack.getMin();   --&gt; Returns -2.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>FindMinimumInRotatedSortedArrayII</title>
      <link href="/2019/03/23/2019-03-23-FindMinimumInRotatedSortedArrayII/"/>
      <url>/2019/03/23/2019-03-23-FindMinimumInRotatedSortedArrayII/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><ol start="154"><li>Find Minimum in Rotated Sorted Array II</li></ol><p>Hard</p><p>Suppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.</p><p>(i.e.,  <code>[0,1,2,4,5,6,7]</code> might become  <code>[4,5,6,7,0,1,2]</code>).</p><p>Find the minimum element.</p><p>The array may contain duplicates.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: [1,3,5]</span><br><span class="line">&gt;Output: 1</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: [2,2,2,0,1]</span><br><span class="line">&gt;Output: 0</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Note:</strong></p><ul><li>This is a follow up problem to <a href="https://leetcode.com/problems/find-minimum-in-rotated-sorted-array/description/" target="_blank" rel="noopener">Find Minimum in Rotated Sorted Array</a>.</li><li>Would allow duplicates affect the run-time complexity? How and why?</li></ul></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>???</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMin</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (nums[i] &gt; nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line"><span class="keyword">return</span> nums[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hard </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FindMinimumInRotatedSortedArray</title>
      <link href="/2019/03/23/2019-03-23-FindMinimumInRotatedSortedArray/"/>
      <url>/2019/03/23/2019-03-23-FindMinimumInRotatedSortedArray/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><ol start="153"><li>Find Minimum in Rotated Sorted Array</li></ol><p>Medium</p><p>Suppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.</p><p>(i.e.,  <code>[0,1,2,4,5,6,7]</code> might become  <code>[4,5,6,7,0,1,2]</code>).</p><p>Find the minimum element.</p><p>You may assume no duplicate exists in the array.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: [3,4,5,1,2] </span><br><span class="line">&gt;Output: 1</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: [4,5,6,7,0,1,2]</span><br><span class="line">&gt;Output: 0</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMin</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (nums[i] &gt; nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line"><span class="keyword">return</span> nums[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I&apos;m the perfect</span><br><span class="line">but this problem will harder in the next problem</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安全防范</title>
      <link href="/2019/03/23/2019-03-23-%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83/"/>
      <url>/2019/03/23/2019-03-23-%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<h1 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h1><ul><li>XSS 攻击：对 Web 页面注入脚本，使用 JavaScript 窃取用户信息，诱导用户操作。</li><li>CSRF 攻击：伪造用户请求向网站发起恶意请求。</li><li>钓鱼攻击：利用网站的跳转链接或者图片制造钓鱼陷阱。</li><li>HTTP参数污染：利用对参数格式验证的不完善，对服务器进行参数注入攻击。</li><li>远程代码执行：用户通过浏览器提交执行命令，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令。</li></ul><h2 id="XSS攻击"><a href="#XSS攻击" class="headerlink" title="XSS攻击"></a>XSS攻击</h2><p>cross-site-scripting跨域脚本攻击</p>]]></content>
      
      
      <categories>
          
          <category> security </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>mysql事务</title>
      <link href="/2019/03/23/2019-03-23-mysql%E4%BA%8B%E5%8A%A1/"/>
      <url>/2019/03/23/2019-03-23-mysql%E4%BA%8B%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>MYSQL事务主要用于保证一串事情要么都成功，要么就回滚，例如付款后，要先写入支付订单表，再个人信息中加入会员权益。这两个操作要么顺序执行成功，要么就回滚</p><h1 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h1><p>ACID</p><ul><li><p>Atomicity原子性</p><p>确保事务内的所有操作都成功完成，否则事务将被中止在故障点，以前的操作将回滚到以前的状态。</p></li><li><p>Consistency一致性</p><p>数据库的修改是一致的</p></li><li><p><strong>Isolation隔离性</strong></p><p>事务是彼此独立的</p></li><li><p>Durability可靠性</p><p>确保事务提交后，结果永久存在</p></li></ul><p><strong>隔离性</strong></p><p>隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括</p><p>读未提交（Read uncommitted）–不严格</p><p>读提交（read committed）</p><p>可重复读（repeatable read）–默认级别（避免幻读）</p><p>串行化（Serializable）–最严格</p><h1 id="没有隔离性的问题"><a href="#没有隔离性的问题" class="headerlink" title="没有隔离性的问题"></a>没有隔离性的问题</h1><h2 id="1-脏读"><a href="#1-脏读" class="headerlink" title="1.脏读"></a>1.脏读</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update account set money=money+100 where name=’B’;</span><br><span class="line">update account set money=money - 100 where name=’A’;</span><br></pre></td></tr></table></figure><p>当执行第一条语句的时候，事务没有提交，那么来读B的账户钱都多了100块</p><p><strong>脏读：读取了另一个事务未提交的数据</strong></p><h2 id="2-不可重复读"><a href="#2-不可重复读" class="headerlink" title="2.不可重复读"></a>2.不可重复读</h2><p>情景：多次读同一个数据的时候，这个数据被别人改了，导致结果不一致</p><h2 id="3-幻读"><a href="#3-幻读" class="headerlink" title="3.幻读"></a>3.幻读</h2><p>幻读和不可重复读一样，读取到了另外一条已经提交的事务，所不同的是它针对的是一批数据的整体</p><h1 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h1><h2 id="自动方式"><a href="#自动方式" class="headerlink" title="自动方式"></a>自动方式</h2><p>beginTransactionScope(scope, ctx)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const result = await app.mysql.beginTransactionScope(async conn =&gt; &#123;</span><br><span class="line">  // don&apos;t commit or rollback by yourself</span><br><span class="line">  await conn.insert(table, row1);</span><br><span class="line">  await conn.update(table, row2);</span><br><span class="line">  return &#123; success: true &#125;;</span><br><span class="line">&#125;, ctx); </span><br><span class="line">// if error throw on scope, will auto rollback</span><br></pre></td></tr></table></figure><h2 id="手动方式"><a href="#手动方式" class="headerlink" title="手动方式"></a>手动方式</h2><p>beginTransaction</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const conn = await app.mysql.beginTransaction(); // 初始化事务</span><br><span class="line">try &#123;</span><br><span class="line">  await conn.insert(table, row1);  // 第一步操作</span><br><span class="line">  await conn.update(table, row2);  // 第二步操作</span><br><span class="line">  await conn.commit(); // 提交事务</span><br><span class="line">&#125; catch (err) &#123;</span><br><span class="line">  // error, rollback</span><br><span class="line">  await conn.rollback(); // 一定记得捕获异常后回滚事务！！</span><br><span class="line">  throw err;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="表达式Literal"><a href="#表达式Literal" class="headerlink" title="表达式Literal"></a>表达式Literal</h1><p>app.mysql.literals.now</p><h1 id="查看数据库事务隔离性级别"><a href="#查看数据库事务隔离性级别" class="headerlink" title="查看数据库事务隔离性级别"></a>查看数据库事务隔离性级别</h1><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;  select @@tx_isolation;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>bashrc</title>
      <link href="/2019/03/15/2019-03-15-bashrc/"/>
      <url>/2019/03/15/2019-03-15-bashrc/</url>
      
        <content type="html"><![CDATA[<h1 id="where"><a href="#where" class="headerlink" title="where"></a>where</h1><p>通常在home目录下的一个隐藏文件，访问可以<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure></p><h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>bash 在每次启动时都会加载 .bashrc 文件的内容。每个用户的 home 目录都有这个 shell 脚本。它用来存储并加载你的终端配置和环境变量</p><h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//更新修改</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>安装mysql服务以及常见问题解决</title>
      <link href="/2019/03/14/2019-03-14-ubuntu%E5%AE%89%E8%A3%85mysql%E6%9C%8D%E5%8A%A1%E4%BB%A5%E5%8F%8A%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
      <url>/2019/03/14/2019-03-14-ubuntu%E5%AE%89%E8%A3%85mysql%E6%9C%8D%E5%8A%A1%E4%BB%A5%E5%8F%8A%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>sudo apt-get update</p><p>sudo apt-get install mysql-server</p><h1 id="解决远程连接"><a href="#解决远程连接" class="headerlink" title="解决远程连接"></a>解决远程连接</h1><blockquote><p>tips本人使用环境ubuntu16</p></blockquote><p>完成安装后，远程连接你会发现2003报错，此时，你对 /etc/mysql/mysql.conf.d/ 文件夹中打开 mysqld.cnf文件修改即可</p><blockquote><p> 修改内容将#bind-address = 127.0.0.1 原本没有注释，进行注释</p></blockquote><p>然后你重新远程连接mysql直接变成1130的拒绝访问服务，接下来你要在服务器端登录mysql，执行 </p><blockquote><p>进入数据库</p><p>mysql -u root -p</p><p>切换数据库,</p><p>mysql&gt;use mysql;</p><p>查看root账号的登录权限,</p><p>mysql&gt;select host, user from user;</p><p>修改登录权限</p><p>mysql&gt;update user set host = ‘%’ where user = ‘root’;</p><p>刷新,生效,最后一步,至关重要</p><p>mysql&gt;flush   privileges;</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SpringbootMQ</title>
      <link href="/2019/03/13/2019-03-13-SpringbootMQ/"/>
      <url>/2019/03/13/2019-03-13-SpringbootMQ/</url>
      
        <content type="html"><![CDATA[<h2 id="what-is-MQ"><a href="#what-is-MQ" class="headerlink" title="what is MQ"></a>what is MQ</h2><p>如果想知道MQ的详细知识可以看我之前的<a href="/2019/01/24/2019-01-24-为什么使用消息队列MQ/">为什么使用消息队列MQ</a></p><p>这里选择最重要的提一下：MQ即消息队列，用来实现程序的异步和解耦，起到消息缓冲，消息分发。通俗来讲就是一个医院（服务器）里面有多个医生（线程或进程），让病人都排队（消息缓冲），有的去A部门，有的去B部门（消息分发）。</p><h2 id="成员RabbitMQ"><a href="#成员RabbitMQ" class="headerlink" title="成员RabbitMQ"></a>成员RabbitMQ</h2><p>RabbitMQ是实现AMQP（高级消息队列协议Advanced Message Queuing Protocol）的消息中间件的一种，Feature就是组件之间解耦，病人排他的队，医生看他的病人，至于怎么排，医生不用操心，至于怎么看病，病人不用操心，都交给MQ</p><p>术语：面向消息，队列，路由（点对点/发布订阅），可靠安全</p>]]></content>
      
      
      <categories>
          
          <category> high_availability </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java问题排查工具</title>
      <link href="/2019/03/13/2019-03-13-Java%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E5%B7%A5%E5%85%B7/"/>
      <url>/2019/03/13/2019-03-13-Java%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<blockquote><p>一下文字摘自JAVA公众号</p></blockquote><h2 id="Linux命令类"><a href="#Linux命令类" class="headerlink" title="Linux命令类"></a>Linux命令类</h2><h3 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h3><p>最常用的tail -f</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -300f shopbase.log #倒数300行并进入实时监听文件写入模式</span><br></pre></td></tr></table></figure><h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">grep forest f.txt     #文件查找</span><br><span class="line">grep forest f.txt cpf.txt #多文件查找</span><br><span class="line">grep &apos;log&apos; /home/admin -r -n #目录下查找所有符合关键字的文件</span><br><span class="line">cat f.txt | grep -i shopbase    </span><br><span class="line">grep &apos;shopbase&apos; /home/admin -r -n --include *.&#123;vm,java&#125; #指定文件后缀</span><br><span class="line">grep &apos;shopbase&apos; /home/admin -r -n --exclude *.&#123;vm,java&#125; #反匹配</span><br><span class="line">seq 10 | grep 5 -A 3    #上匹配</span><br><span class="line">seq 10 | grep 5 -B 3    #下匹配</span><br><span class="line">seq 10 | grep 5 -C 3    #上下匹配，平时用这个就妥了</span><br><span class="line">cat f.txt | grep -c &apos;SHOPBASE&apos;</span><br></pre></td></tr></table></figure><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>1 基础命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk &apos;&#123;print $4,$6&#125;&apos; f.txt</span><br><span class="line">awk &apos;&#123;print NR,$0&#125;&apos; f.txt cpf.txt    </span><br><span class="line">awk &apos;&#123;print FNR,$0&#125;&apos; f.txt cpf.txt</span><br><span class="line">awk &apos;&#123;print FNR,FILENAME,$0&#125;&apos; f.txt cpf.txt</span><br><span class="line">awk &apos;&#123;print FILENAME,&quot;NR=&quot;NR,&quot;FNR=&quot;FNR,&quot;$&quot;NF&quot;=&quot;$NF&#125;&apos; f.txt cpf.txt</span><br><span class="line">echo 1:2:3:4 | awk -F: &apos;&#123;print $1,$2,$3,$4&#125;&apos;</span><br></pre></td></tr></table></figure><p>2 匹配</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk &apos;/ldb/ &#123;print&#125;&apos; f.txt   #匹配ldb</span><br><span class="line">awk &apos;!/ldb/ &#123;print&#125;&apos; f.txt  #不匹配ldb</span><br><span class="line">awk &apos;/ldb/ &amp;&amp; /LISTEN/ &#123;print&#125;&apos; f.txt   #匹配ldb和LISTEN</span><br><span class="line">awk &apos;$5 ~ /ldb/ &#123;print&#125;&apos; f.txt #第五列匹配ldb</span><br></pre></td></tr></table></figure><p>3 内建变量</p><p>NR:NR表示从awk开始执行后，按照记录分隔符读取的数据次数，默认的记录分隔符为换行符，因此默认的就是读取的数据行数，NR可以理解为Number of Record的缩写。</p><p>FNR:在awk处理多个输入文件的时候，在处理完第一个文件后，NR并不会从1开始，而是继续累加，因此就出现了FNR，每当处理一个新文件的时候，FNR就从1开始计数，FNR可以理解为File Number of Record。</p><p>NF: NF表示目前的记录被分割的字段的数目，NF可以理解为Number of Field。</p><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin find /home/admin /tmp /usr -name \*.log(多个目录去找)</span><br><span class="line">find . -iname \*.txt(大小写都匹配)</span><br><span class="line">find . -type d(当前目录下的所有子目录)</span><br><span class="line">find /usr -type l(当前目录下所有的符号链接)</span><br><span class="line">find /usr -type l -name &quot;z*&quot; -ls(符号链接的详细信息 eg:inode,目录)</span><br><span class="line">find /home/admin -size +250000k(超过250000k的文件，当然+改成-就是小于了)</span><br><span class="line">find /home/admin f -perm 777 -exec ls -l &#123;&#125; \; (按照权限查询文件)</span><br><span class="line">find /home/admin -atime -1  1天内访问过的文件</span><br><span class="line">find /home/admin -ctime -1  1天内状态改变过的文件    </span><br><span class="line">find /home/admin -mtime -1  1天内修改过的文件</span><br><span class="line">find /home/admin -amin -1  1分钟内访问过的文件</span><br><span class="line">find /home/admin -cmin -1  1分钟内状态改变过的文件    </span><br><span class="line">find /home/admin -mmin -1  1分钟内修改过的文件</span><br></pre></td></tr></table></figure><h3 id="pgm"><a href="#pgm" class="headerlink" title="pgm"></a>pgm</h3><p>批量查询vm-shopbase满足条件的日志</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pgm -A -f vm-shopbase &apos;cat /home/admin/shopbase/logs/shopbase.log.2017-01-17|grep 2069861630&apos;</span><br></pre></td></tr></table></figure><h3 id="tsar"><a href="#tsar" class="headerlink" title="tsar"></a>tsar</h3><p>tsar是咱公司自己的采集工具。很好用, 将历史收集到的数据持久化在磁盘上，所以我们快速来查询历史的系统数据。当然实时的应用情况也是可以查询的啦。大部分机器上都有安装。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsar  ##可以查看最近一天的各项指标</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/fc25b8f22e53818d5576c5d00dd52618.png" alt="screenshot.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsar --live ##可以查看实时指标，默认五秒一刷</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/b68910c5416fd85a99a49a092fc9ffbb.png" alt="screenshot.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsar -d 20161218 ##指定查看某天的数据，貌似最多只能看四个月的数据</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/aafdbfb515b817a2aceb270d1d470c19.png" alt="screenshot.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tsar --mem</span><br><span class="line">tsar --load</span><br><span class="line">tsar --cpu</span><br><span class="line">##当然这个也可以和-d参数配合来查询某天的单个指标的情况</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/cb46ef4e374e1502d3b672d04d48099a.png" alt="screenshot.png"><br><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/079f3fa722bfa1991557469eb97c7273.png" alt="screenshot.png"><br><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/6dd77351ad4d1ad84cdbfba20c9d4c29.png" alt="screenshot.png"></p><h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><p>top除了看一些基本信息之外，剩下的就是配合来查询vm的各种问题了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java</span><br><span class="line">top -H -p pid</span><br></pre></td></tr></table></figure><p>获得线程10进制转16进制后jstack去抓看这个线程到底在干啥</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat|awk  &apos;&#123;print $6&#125;&apos;|sort|uniq -c|sort -rn </span><br><span class="line">#查看当前连接，注意close_wait偏高的情况，比如如下</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/250a027410775cf5990d0db6e87ba927.png" alt="screenshot.png"><br><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/639811da529750064e2f70867d6234e0.png" alt="screenshot.png"></p><h2 id="排查利器"><a href="#排查利器" class="headerlink" title="排查利器"></a>排查利器</h2><h3 id="btrace"><a href="#btrace" class="headerlink" title="btrace"></a>btrace</h3><p>首当其冲的要说的是btrace。真是生产环境&amp;预发的排查问题大杀器。 简介什么的就不说了。直接上代码干</p><ol><li><p>查看当前谁调用了ArrayList的add方法，同时只打印当前ArrayList的size大于500的线程调用栈</p><p>@OnMethod(clazz = “java.util.ArrayList”, method=”add”, location = @Location(value = Kind.CALL, clazz = “/.<em>/“, method = “/.</em>/“))<br>public static void m(@ProbeClassName String probeClass, @ProbeMethodName String probeMethod, @TargetInstance Object instance, @TargetMethodOrField String method) {</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if(getInt(field(&quot;java.util.ArrayList&quot;, &quot;size&quot;), instance) &gt; 479)&#123;</span><br><span class="line">    println(&quot;check who ArrayList.add method:&quot; + probeClass + &quot;#&quot; + probeMethod  + &quot;, method:&quot; + method + &quot;, size:&quot; + getInt(field(&quot;java.util.ArrayList&quot;, &quot;size&quot;), instance));</span><br><span class="line">    jstack();</span><br><span class="line">    println();</span><br><span class="line">    println(&quot;===========================&quot;);</span><br><span class="line">    println();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>}</p></li><li><p>监控当前服务方法被调用时返回的值以及请求的参数</p><p>@OnMethod(clazz = “com.taobao.sellerhome.transfer.biz.impl.C2CApplyerServiceImpl”, method=”nav”, location = @Location(value = Kind.RETURN))<br>public static void mt(long userId, int current, int relation, String check, String redirectUrl, @Return AnyType result) {</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">println(&quot;parameter# userId:&quot; + userId + &quot;, current:&quot; + current + &quot;, relation:&quot; + relation + &quot;, check:&quot; + check + &quot;, redirectUrl:&quot; + redirectUrl + &quot;, result:&quot; + result);</span><br></pre></td></tr></table></figure><p>}</p></li></ol><p>其他功能集团的一些工具或多或少都有，就不说了。感兴趣的请移步。<br><a href="https://github.com/btraceio/btrace" target="_blank" rel="noopener">https://github.com/btraceio/btrace</a></p><p>注意:</p><ol><li>经过观察，1.3.9的release输出不稳定，要多触发几次才能看到正确的结果</li><li>正则表达式匹配trace类时范围一定要控制，否则极有可能出现跑满CPU导致应用卡死的情况</li><li>由于是字节码注入的原理，想要应用恢复到正常情况，需要重启应用。</li></ol><h3 id="Greys"><a href="#Greys" class="headerlink" title="Greys"></a>Greys</h3><p>Greys是@杜琨的大作吧。说几个挺棒的功能(部分功能和btrace重合):</p><p><code>sc -df xxx</code>: 输出当前类的详情,包括源码位置和classloader结构</p><p><code>trace class method</code>: 相当喜欢这个功能! 很早前可以早JProfiler看到这个功能。打印出当前方法调用的耗时情况，细分到每个方法。对排查方法性能时很有帮助，比如我之前这篇就是使用了trace命令来的:<a href="http://www.atatech.org/articles/52947" target="_blank" rel="noopener">http://www.atatech.org/articles/52947</a>。</p><p>其他功能部分和btrace重合，可以选用，感兴趣的请移步。<br><a href="http://www.atatech.org/articles/26247" target="_blank" rel="noopener">http://www.atatech.org/articles/26247</a></p><p>另外相关联的是arthas，他是基于Greys的，感兴趣的再移步<a href="http://mw.alibaba-inc.com/products/arthas/docs/middleware-container/arthas.wiki/home.html?spm=a1z9z.8109794.header.32.1lsoMc" target="_blank" rel="noopener">http://mw.alibaba-inc.com/products/arthas/docs/middleware-container/arthas.wiki/home.html?spm=a1z9z.8109794.header.32.1lsoMc</a></p><h3 id="javOSize"><a href="#javOSize" class="headerlink" title="javOSize"></a>javOSize</h3><p>就说一个功能<br><code>classes</code>：通过修改了字节码，改变了类的内容，即时生效。 所以可以做到快速的在某个地方打个日志看看输出，缺点是对代码的侵入性太大。但是如果自己知道自己在干嘛，的确是不错的玩意儿。</p><p>其他功能Greys和btrace都能很轻易做的到，不说了。</p><p>可以看看我之前写的一篇javOSize的简介<a href="http://www.atatech.org/articles/38546" target="_blank" rel="noopener">http://www.atatech.org/articles/38546</a><br>官网请移步<a href="http://www.javosize.com/" target="_blank" rel="noopener">http://www.javosize.com/</a></p><h3 id="JProfiler"><a href="#JProfiler" class="headerlink" title="JProfiler"></a>JProfiler</h3><p>之前判断许多问题要通过JProfiler，但是现在Greys和btrace基本都能搞定了。再加上出问题的基本上都是生产环境(网络隔离)，所以基本不怎么使用了，但是还是要标记一下。<br>官网请移步<a href="https://www.ej-technologies.com/products/jprofiler/overview.html" target="_blank" rel="noopener">https://www.ej-technologies.com/products/jprofiler/overview.html</a></p><h2 id="大杀器"><a href="#大杀器" class="headerlink" title="大杀器"></a>大杀器</h2><h3 id="eclipseMAT"><a href="#eclipseMAT" class="headerlink" title="eclipseMAT"></a>eclipseMAT</h3><p>可作为eclipse的插件，也可作为单独的程序打开。<br>详情请移步<a href="http://www.eclipse.org/mat/" target="_blank" rel="noopener">http://www.eclipse.org/mat/</a></p><h3 id="zprofiler"><a href="#zprofiler" class="headerlink" title="zprofiler"></a>zprofiler</h3><p>集团内的开发应该是无人不知无人不晓了。简而言之一句话:有了zprofiler还要mat干嘛<br>详情请移步<a href="http://zprofiler.alibaba-inc.com/" target="_blank" rel="noopener">zprofiler.alibaba-inc.com</a></p><h2 id="java三板斧，噢不对，是七把"><a href="#java三板斧，噢不对，是七把" class="headerlink" title="java三板斧，噢不对，是七把"></a>java三板斧，噢不对，是七把</h2><h3 id="jps"><a href="#jps" class="headerlink" title="jps"></a>jps</h3><p>我只用一条命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/java/bin/jps -mlvV</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/7b156cb53250bf5f91811900c2575a91.png" alt="screenshot.png"></p><h3 id="jstack"><a href="#jstack" class="headerlink" title="jstack"></a>jstack</h3><p>普通用法:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jstack 2815</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/bc501bf424b3d2884e6ec118d14554a3.png" alt="screenshot.png"></p><p>native+java栈:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jstack -m 2815</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/4c59dc2971f3d8778e1898d64266266a.png" alt="screenshot.png"></p><h3 id="jinfo"><a href="#jinfo" class="headerlink" title="jinfo"></a>jinfo</h3><p>可看系统启动的参数，如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jinfo -flags 2815</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/bc879145e2994e9a09327407ed88382c.png" alt="screenshot.png"></p><h3 id="jmap"><a href="#jmap" class="headerlink" title="jmap"></a>jmap</h3><p>两个用途</p><p>1.查看堆的情况</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jmap -heap 2815</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/00d9eaef08cdb51263d202d26795036b.png" alt="screenshot.png"><br><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/3c08bccf81fef8b7bcae2b321012b503.png" alt="screenshot.png"></p><p>2.dump</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jmap -dump:live,format=b,file=/tmp/heap2.bin 2815</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jmap -dump:format=b,file=/tmp/heap3.bin 2815</span><br></pre></td></tr></table></figure><p>3.看看堆都被谁占了? 再配合zprofiler和btrace，排查问题简直是如虎添翼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jmap -histo 2815 | head -10</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/500ec6709fcd03a4fca2679615d54522.png" alt="screenshot.png"></p><h3 id="jstat"><a href="#jstat" class="headerlink" title="jstat"></a>jstat</h3><p>jstat参数众多，但是使用一个就够了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/install/ajdk-8_1_1_fp1-b52/bin/jstat -gcutil 2815 1000</span><br></pre></td></tr></table></figure><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/05743916a9187535c202fb410d30d50d.png" alt="screenshot.png"></p><h3 id="jdb"><a href="#jdb" class="headerlink" title="jdb"></a>jdb</h3><p>时至今日，jdb也是经常使用的。<br>jdb可以用来预发debug,假设你预发的java_home是/opt/taobao/java/，远程调试端口是8000.那么<br><code>sudo -u admin /opt/taobao/java/bin/jdb -attach 8000</code>.</p><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/16332fcd45b20137bffc7a3b9a88b0f1.png" alt="screenshot.png"></p><p>出现以上代表jdb启动成功。后续可以进行设置断点进行调试。<br>具体参数可见oracle官方说明<a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html" target="_blank" rel="noopener">http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html</a></p><h3 id="CHLSDB"><a href="#CHLSDB" class="headerlink" title="CHLSDB"></a>CHLSDB</h3><p>CHLSDB感觉很多情况下可以看到更好玩的东西，不详细叙述了。 查询资料听说jstack和jmap等工具就是基于它的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u admin /opt/taobao/java/bin/java -classpath /opt/taobao/java/lib/sa-jdi.jar sun.jvm.hotspot.CLHSDB</span><br></pre></td></tr></table></figure><p>更详细的可见R大此贴<br><a href="http://rednaxelafx.iteye.com/blog/1847971" target="_blank" rel="noopener">http://rednaxelafx.iteye.com/blog/1847971</a></p><h2 id="plugin-of-intellij-idea"><a href="#plugin-of-intellij-idea" class="headerlink" title="plugin of intellij idea"></a>plugin of intellij idea</h2><h3 id="key-promoter"><a href="#key-promoter" class="headerlink" title="key promoter"></a>key promoter</h3><p>快捷键一次你记不住，多来几次你总能记住了吧？</p><p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/356c11885a95e28736a605aecdc8083e.png" alt="screenshot.png"></p><h3 id="maven-helper"><a href="#maven-helper" class="headerlink" title="maven helper"></a>maven helper</h3><p>分析maven依赖的好帮手。</p><h2 id="VM-options"><a href="#VM-options" class="headerlink" title="VM options"></a>VM options</h2><ol><li><p>你的类到底是从哪个文件加载进来的？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-XX:+TraceClassLoading</span><br><span class="line">结果形如[Loaded java.lang.invoke.MethodHandleImpl$Lazy from D:\programme\jdk\jdk8U74\jre\lib\rt.jar]</span><br></pre></td></tr></table></figure></li><li><p>应用挂了输出dump文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/admin/logs/java.hprof</span><br><span class="line">集团的vm参数里边基本都有这个选项</span><br></pre></td></tr></table></figure></li></ol><h2 id="jar包冲突"><a href="#jar包冲突" class="headerlink" title="jar包冲突"></a>jar包冲突</h2><p>把这个单独写个大标题不过分吧？每个人或多或少都处理过这种烦人的case。我特么下边这么多方案不信就搞不定你?</p><h3 id="mvn-dependency-tree-gt-dependency-txt"><a href="#mvn-dependency-tree-gt-dependency-txt" class="headerlink" title="mvn dependency:tree &gt; ~/dependency.txt"></a>mvn dependency:tree &gt; ~/dependency.txt</h3><p>打出所有依赖</p><h3 id="mvn-dependency-tree-Dverbose-Dincludes-groupId-artifactId"><a href="#mvn-dependency-tree-Dverbose-Dincludes-groupId-artifactId" class="headerlink" title="mvn dependency:tree -Dverbose -Dincludes=groupId:artifactId"></a>mvn dependency:tree -Dverbose -Dincludes=groupId:artifactId</h3><p>只打出指定groupId和artifactId的依赖关系</p><h3 id="XX-TraceClassLoading"><a href="#XX-TraceClassLoading" class="headerlink" title="-XX:+TraceClassLoading"></a>-XX:+TraceClassLoading</h3><p>vm启动脚本加入。在tomcat启动脚本中可见加载类的详细信息</p><h3 id="verbose"><a href="#verbose" class="headerlink" title="-verbose"></a>-verbose</h3><p>vm启动脚本加入。在tomcat启动脚本中可见加载类的详细信息</p><h3 id="greys-sc"><a href="#greys-sc" class="headerlink" title="greys:sc"></a>greys:sc</h3><p>greys的sc命令也能清晰的看到当前类是从哪里加载过来的</p><h3 id="tomcat-classloader-locate"><a href="#tomcat-classloader-locate" class="headerlink" title="tomcat-classloader-locate"></a>tomcat-classloader-locate</h3><p>通过以下url可以获知当前类是从哪里加载的<br>curl <a href="http://localhost:8006/classloader/locate?class=org.apache.xerces.xs.XSObject" target="_blank" rel="noopener">http://localhost:8006/classloader/locate?class=org.apache.xerces.xs.XSObject</a></p><h2 id="ALI-TOMCAT带给我们的惊喜-感谢-务观"><a href="#ALI-TOMCAT带给我们的惊喜-感谢-务观" class="headerlink" title="ALI-TOMCAT带给我们的惊喜(感谢@务观)"></a>ALI-TOMCAT带给我们的惊喜(感谢@务观)</h2><ol><li><p>列出容器加载的jar列表</p><p>curl <a href="http://localhost:8006/classloader/jars" target="_blank" rel="noopener">http://localhost:8006/classloader/jars</a></p></li><li><p>列出当前当当前类加载的实际jar包位置，解决类冲突时有用</p><p>curl <a href="http://localhost:8006/classloader/locate?class=org.apache.xerces.xs.XSObject" target="_blank" rel="noopener">http://localhost:8006/classloader/locate?class=org.apache.xerces.xs.XSObject</a><br><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/4568b16d3db0daf98e852412b830f1a8.png" alt="screenshot.png"></p></li></ol><h2 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h2><h3 id="gpref"><a href="#gpref" class="headerlink" title="gpref"></a>gpref</h3><p><a href="http://www.atatech.org/articles/33317" target="_blank" rel="noopener">http://www.atatech.org/articles/33317</a></p><h3 id="dmesg"><a href="#dmesg" class="headerlink" title="dmesg"></a>dmesg</h3><p>如果发现自己的java进程悄无声息的消失了，几乎没有留下任何线索，那么dmesg一发，很有可能有你想要的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dmesg|grep -i kill|less</span><br></pre></td></tr></table></figure><p>去找关键字oom_killer。找到的结果类似如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[6710782.021013] java invoked oom-killer: gfp_mask=0xd0, order=0, oom_adj=0, oom_scoe_adj=0</span><br><span class="line">[6710782.070639] [&lt;ffffffff81118898&gt;] ? oom_kill_process+0x68/0x140 </span><br><span class="line">[6710782.257588] Task in /LXC011175068174 killed as a result of limit of /LXC011175068174 </span><br><span class="line">[6710784.698347] Memory cgroup out of memory: Kill process 215701 (java) score 854 or sacrifice child </span><br><span class="line">[6710784.707978] Killed process 215701, UID 679, (java) total-vm:11017300kB, anon-rss:7152432kB, file-rss:1232kB</span><br></pre></td></tr></table></figure><p>以上表明，对应的java进程被系统的OOM Killer给干掉了，得分为854.<br>解释一下OOM killer（Out-Of-Memory killer），该机制会监控机器的内存资源消耗。当机器内存耗尽前，该机制会扫描所有的进程（按照一定规则计算，内存占用，时间等），挑选出得分最高的进程，然后杀死，从而保护机器。</p><p>dmesg日志时间转换公式:<br>log实际时间=格林威治1970-01-01+(当前时间秒数-系统启动至今的秒数+dmesg打印的log时间)秒数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -d &quot;1970-01-01 UTC `echo &quot;$(date +%s)-$(cat /proc/uptime|cut -f 1 -d&apos; &apos;)+12288812.926194&quot;|bc ` seconds&quot;</span><br></pre></td></tr></table></figure><p>剩下的，就是看看为什么内存这么大，触发了OOM-Killer了。</p><h2 id="新技能get"><a href="#新技能get" class="headerlink" title="新技能get"></a>新技能get</h2><h3 id="RateLimiter"><a href="#RateLimiter" class="headerlink" title="RateLimiter"></a>RateLimiter</h3><p>想要精细的控制QPS? 比如这样一个场景，你调用某个接口，对方明确需要你限制你的QPS在400之内你怎么控制？这个时候RateLimiter就有了用武之地。详情可移步<a href="http://ifeve.com/guava-ratelimiter/" target="_blank" rel="noopener">http://ifeve.com/guava-ratelimite</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JumpGame</title>
      <link href="/2019/03/13/2019-03-13-JumpGame/"/>
      <url>/2019/03/13/2019-03-13-JumpGame/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>Given an array of non-negative integers, you are initially positioned at the first index of the array.</p><p>Each element in the array represents your maximum jump length at that position.</p><p>Determine if you are able to reach the last index.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [2,3,1,1,4]</span><br><span class="line">&gt; Output: true</span><br><span class="line">&gt; Explanation: Jump 1 step from index 0 to 1, then 3 steps to the last index.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [3,2,1,0,4]</span><br><span class="line">&gt; Output: false</span><br><span class="line">&gt; Explanation: You will always arrive at index 3 no matter what. Its maximum</span><br><span class="line">&gt;              jump length is 0, which makes it impossible to reach the last index.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>本题有两个易理解错的地方</p><ul><li>达到最后一个index或者超过最后一个index是可以的</li><li>【2,5,0,0】第一个2可以跳两步，然后我们在5的基础上跳五步</li></ul><p>本题采用贪心算法，算出局部最优解就可以了，当然也可以考虑dp，但本题没有这个必要</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canJump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> reach = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length &amp;&amp; reach &gt;= i; i++)</span><br><span class="line">            <span class="keyword">if</span>(i + nums[i] &gt; reach) reach = i + nums[i];</span><br><span class="line">        <span class="keyword">return</span> reach &gt;= (nums.length-<span class="number">1</span>) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I&apos;m the perfect</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpiralMatrix</title>
      <link href="/2019/03/12/2019-03-12-SpiralMatrix/"/>
      <url>/2019/03/12/2019-03-12-SpiralMatrix/</url>
      
        <content type="html"><![CDATA[<h1 id="54-problem"><a href="#54-problem" class="headerlink" title="54.problem"></a>54.problem</h1><blockquote><p>Given a matrix of <em>m</em> x <em>n</em> elements (<em>m</em> rows, <em>n</em> columns), return all elements of the matrix in spiral order.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input:</span><br><span class="line">&gt; [</span><br><span class="line">&gt;  [ 1, 2, 3 ],</span><br><span class="line">&gt;  [ 4, 5, 6 ],</span><br><span class="line">&gt;  [ 7, 8, 9 ]</span><br><span class="line">&gt; ]</span><br><span class="line">&gt; Output: [1,2,3,6,9,8,7,4,5]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input:</span><br><span class="line">&gt; [</span><br><span class="line">&gt;   [1, 2, 3, 4],</span><br><span class="line">&gt;   [5, 6, 7, 8],</span><br><span class="line">&gt;   [9,10,11,12]</span><br><span class="line">&gt; ]</span><br><span class="line">&gt; Output: [1,2,3,4,8,12,11,10,9,5,6,7]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>很简单的循环输出的例子，从【0,0】的位置顺时针扫一圈，然后缩小一圈，继续扫描，不过有一个细节就是第三次第四循环前，要判断一下,防止最后一层循环只有一行</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">spiralOrder</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; ans = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"><span class="keyword">if</span> (matrix.length == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line"><span class="keyword">int</span> rs = <span class="number">0</span>, re = matrix.length - <span class="number">1</span>;<span class="comment">// rowStart rowEnd</span></span><br><span class="line"><span class="keyword">int</span> cs = <span class="number">0</span>, ce = matrix[<span class="number">0</span>].length - <span class="number">1</span>;<span class="comment">// columnStart columnEnd</span></span><br><span class="line"><span class="keyword">while</span> (rs &lt;= re &amp;&amp; cs &lt;= ce) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = cs; i &lt;= ce; i++) &#123;</span><br><span class="line">ans.add(matrix[rs][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=rs+<span class="number">1</span>;j&lt;=re;j++) &#123;</span><br><span class="line">ans.add(matrix[j][ce]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(rs&lt;re&amp;&amp;cs&lt;ce) &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k=ce-<span class="number">1</span>;k&gt;cs;k--) &#123;</span><br><span class="line">ans.add(matrix[re][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=re;l&gt;rs;l--) &#123;</span><br><span class="line">ans.add(matrix[l][cs]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rs++;</span><br><span class="line">re--;</span><br><span class="line">cs++;</span><br><span class="line">ce--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yehh,I&apos;m the perfect</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何设置hexo的favico</title>
      <link href="/2019/03/12/2019-03-12-%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AEhexo%E7%9A%84favico/"/>
      <url>/2019/03/12/2019-03-12-%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AEhexo%E7%9A%84favico/</url>
      
        <content type="html"><![CDATA[<h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><p>source 下放置32*32的favico.icon文件并在根目录的_config.yml中设置</p><blockquote><p>favicon: /favicon.ico</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>如何将域名绑定到hexo</title>
      <link href="/2019/03/12/2019-03-12-%E5%A6%82%E4%BD%95%E5%B0%86%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A%E5%88%B0hexo/"/>
      <url>/2019/03/12/2019-03-12-%E5%A6%82%E4%BD%95%E5%B0%86%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A%E5%88%B0hexo/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><p>很多人可能都有hexo博客，会有一个githubname.github.io的地址，然后自己可能想去买一个域名，方便记忆，但是解析后迟迟用不了，该文章就来详细描述一下步骤。</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><p>1.拥有一个githubname.github.io可以正常访问的域名，如我的GitHub博客：<a href="https://shawngoethe.github.io" target="_blank" rel="noopener">https://shawngoethe.github.io</a></p><p>2.购买域名，个人推荐阿里云，首年年费比较便宜，适合个人折腾，博客建议com,me,info,pro（专家）,mobi(kindle电子书的格式)，再不济可以选择tech，cc之类的，国外可以参考Linost之类的网页</p><p>3.购买域名进行实名认证，否则无法使用</p><p>4.进行解析：记录类型CNAME（进行转发），主机记录@（避免主机记录选择www，输入域名要多写www），记录值为shawngoethe.github.io,TTL选择10分钟就可以了</p><blockquote><p>上述方法属于将我购买的zehai.info转发到了shawngoethe.github.io,还可以“记录类型”选择“A”来填写IPv4的地址，地址可以通过ping shawngoethe.github.io 来获得</p></blockquote><p>5.<strong>修改代码</strong>：很多人忽视了要在源代码/hexoblog/source/目录下添加CNAME文件（注意没有尾缀），然后在该文件下填写zehai.info（可以兼容，<a href="http://www.zehai.info" target="_blank" rel="noopener">www.zehai.info</a>  和 zehai.info 两种访问方式，但如果填写 <a href="http://www.zehai.info" target="_blank" rel="noopener">www.zehai.info</a> 则只支持 <a href="http://www.zehai.info" target="_blank" rel="noopener">www.zehai.info</a> 一种访问方式）</p><p>6.等十分钟左右，让解析生效，好了，你可以访问<a href="zehai.info"><strong>我的hexo</strong></a>获取更多内容</p>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MaximumSubarray</title>
      <link href="/2019/03/10/2019-03-10-MaximumSubarray/"/>
      <url>/2019/03/10/2019-03-10-MaximumSubarray/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>Maximum Subarray</p><p>Easy</p><p>Given an integer array <code>nums</code>, find the contiguous subarray (containing at least one number) which has the largest sum and return its sum.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [-2,1,-3,4,-1,2,1,-5,4],</span><br><span class="line">&gt; Output: 6</span><br><span class="line">&gt; Explanation: [4,-1,2,1] has the largest sum = 6.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Follow up:</strong></p><p>If you have figured out the O(<em>n</em>) solution, try coding another solution using the divide and conquer approach, which is more subtle.</p></blockquote><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>我们定义一个和为第一位数，然后用curSum来保存递增量</p><p>ps ans–&gt;answer  cur–&gt;cursor</p><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans=nums[<span class="number">0</span>], curSum=<span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;nums.length; i++) &#123;</span><br><span class="line">            curSum = curSum + nums[i];</span><br><span class="line">            ans = Math.max(ans, curSum);</span><br><span class="line">            curSum = Math.max(<span class="number">0</span>, curSum);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp = nums[<span class="number">0</span>], maxSum=nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;nums.length; i++) &#123;</span><br><span class="line">            dp = dp&lt;<span class="number">0</span>?nums[i]:nums[i]+dp;</span><br><span class="line">            maxSum=Math.max(maxSum, dp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxSum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>pow(x,n)</title>
      <link href="/2019/03/10/2019-03-10-pow-x-n/"/>
      <url>/2019/03/10/2019-03-10-pow-x-n/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>\50. Pow(x, n)</p><p>Medium</p><p>Implement <a href="http://www.cplusplus.com/reference/valarray/pow/" target="_blank" rel="noopener">pow(<em>x</em>, <em>n</em>)</a>, which calculates <em>x</em> raised to the power <em>n</em> (xn).</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: 2.00000, 10</span><br><span class="line">&gt; Output: 1024.00000</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: 2.10000, 3</span><br><span class="line">&gt; Output: 9.26100</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: 2.00000, -2</span><br><span class="line">&gt; Output: 0.25000</span><br><span class="line">&gt; Explanation: 2-2 = 1/22 = 1/4 = 0.25</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Note:</strong></p><ul><li>-100.0 &lt; <em>x</em> &lt; 100.0</li><li><em>n</em> is a 32-bit signed integer, within the range [−231, 231 − 1]</li></ul></blockquote><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">myPow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> N = n;</span><br><span class="line"><span class="keyword">if</span> (N &lt; <span class="number">0</span>) &#123;</span><br><span class="line">x = <span class="number">1</span> / x;</span><br><span class="line">N = -N;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">double</span> cur = x;<span class="comment">//2</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">long</span> i = N; i &gt; <span class="number">0</span>; i /= <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">1</span>)</span><br><span class="line">ans = ans * cur;</span><br><span class="line">cur = cur * cur;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//偷懒方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">myPow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> Math.pow(x, n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>其实先使用了偷懒的方法，调用Math库的pow方法，然后写过一版</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">long</span> i=N;i&gt;<span class="number">0</span>;i--) &#123;</span><br><span class="line">ans=ans*cur;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个会直接报超时的错误，因为的计算量会非常大，在计算（-1.00000，-2147483648）时候超时了，虽然我们可以通过判断x来避免这一个超时，但是我想到了，可以通过n/2来迅速减少相乘的次数。时间大概是8ms</p><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findPower</span><span class="params">(<span class="keyword">double</span> x,<span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n == Long.valueOf(<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">if</span>(n % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">double</span> half_pow = findPower(x,n/<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> half_pow * half_pow;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">double</span> half_pow = findPower(x,(n-<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> half_pow * half_pow * x;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">myPow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>( n==<span class="number">0</span> )</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">         </span><br><span class="line">            <span class="keyword">long</span> n_long = (<span class="keyword">long</span>) n;</span><br><span class="line">            <span class="keyword">if</span>( n &gt; <span class="number">0</span> )</span><br><span class="line">                <span class="keyword">return</span> findPower(x,n);</span><br><span class="line">            </span><br><span class="line">            x = <span class="number">1</span> / x;</span><br><span class="line">            <span class="keyword">long</span> n_long_abs =  (<span class="keyword">long</span>) Math.abs((<span class="keyword">long</span>)n);</span><br><span class="line">            <span class="keyword">if</span>(n_long_abs == <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> x;</span><br><span class="line">            <span class="keyword">return</span> findPower(x,n_long_abs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>我在一个不属于我的地方游荡</title>
      <link href="/2019/03/06/2019-03-06-%E6%88%91%E5%9C%A8%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%B1%9E%E4%BA%8E%E6%88%91%E7%9A%84%E5%9C%B0%E6%96%B9%E6%B8%B8%E8%8D%A1/"/>
      <url>/2019/03/06/2019-03-06-%E6%88%91%E5%9C%A8%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%B1%9E%E4%BA%8E%E6%88%91%E7%9A%84%E5%9C%B0%E6%96%B9%E6%B8%B8%E8%8D%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="我在一个不属于我的地方游荡"><a href="#我在一个不属于我的地方游荡" class="headerlink" title="我在一个不属于我的地方游荡"></a>我在一个不属于我的地方游荡</h1><p>2019年的3月6日，距离我上一份工作离职，已经37天，日子过得虽然不好，但也不算差，好消息是阿len还陪着我，坏消息是一直过着异地恋的生活，不知道是为什么，是我进入了焦虑的状态，每天的日常就是投简历，思考人生，发呆，看up主秀恩爱</p><p>其实回顾前三次的找工作经历，哪次不是觉得自己快要变成咸鱼了，然后收到了一两个offer，不过今年的不同点就是，有三家，我已经过了用人单位的面试，却被卡在了人力资源部门的审核上，我时常恨自己的学历，却无法去原谅曾经高考的自己，写这篇文章的时候，我刚刚从清华的北门进入校园，下午两点半的宿舍区，没有一点噪音，天空的乌鸦鸣叫在空旷的校园回荡，仿佛，在感叹今日的好天气，阳光那么明亮，洒在光秃秃的树枝上。</p><p><img src="\img\微信图片_20190310214720.jpg" alt="1552225241907"></p><p>17年考研复习期间埋下来的雷，最终还是爆炸了，18年，19年，20年，似乎时间过得很快，我丢失了那一次机会后，我似乎再也没有机会去投入身心去复习，每天的大脑里更多的是，好累啊，好烦啊，什么时候发工资啊。越生是怀念起无忧无虑的本科生活，天天不用担心我是谁，我在哪儿，学什么，可能唯一需要费点脑经的就是，中午吃啥</p><p><img src="\img\微信图片_20190310214704.jpg" alt="1552225254472"></p><p>而现在，我走在一个不属于我的世界里，熟悉又陌生，我什么都不知道，因为我不知道我要干嘛，前方一个是找不到工作的工作方向，一个是会饿死的考研方向，世界很精彩，我却显得那么渺小，就深深想起来用人部门发信息和我说：</p><blockquote><p>从技术层面上，我认为从工作年限上，你的水平是够的。对于候选人的学历背景上，央企有自身的痼疾，用人部门的话语权不一定大于人力部门，这个你也无须介怀。</p><p>工作的前三年对于一个工程师来说是至关重要的，如果喜欢这条路，就多花点时间，加油！江湖不大，有缘再见！</p></blockquote><p>不知道接下来应该做什么，或许这就是应试教育的悲哀，我也只能许愿，三月份能够拿到一个不错的offer，先活下来，我是子苏，一个快要得抑郁症的人。</p>]]></content>
      
      
      <categories>
          
          <category> mood </category>
          
      </categories>
      
      
        <tags>
            
            <tag> diary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker+springboot</title>
      <link href="/2019/03/05/2019-03-05-docker-springboot/"/>
      <url>/2019/03/05/2019-03-05-docker-springboot/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>在 <code>pom.xml-properties</code>中添加 Docker 镜像名称</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">&lt;docker.image.prefix&gt;springboot&lt;/docker.image.prefix&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure><p>plugins 中添加 Docker 构建插件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br><span class="line">&lt;!-- Docker maven plugin --&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;com.spotify&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;imageName&gt;$&#123;docker.image.prefix&#125;/$&#123;project.artifactId&#125;&lt;/imageName&gt;</span><br><span class="line">&lt;dockerDirectory&gt;src/main/docker&lt;/dockerDirectory&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;resource&gt;</span><br><span class="line">&lt;targetPath&gt;/&lt;/targetPath&gt;</span><br><span class="line">&lt;directory&gt;$&#123;project.build.directory&#125;&lt;/directory&gt;</span><br><span class="line">&lt;include&gt;$&#123;project.build.finalName&#125;.jar&lt;/include&gt;</span><br><span class="line">&lt;/resource&gt;</span><br><span class="line">&lt;/resources&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br><span class="line">&lt;!-- Docker maven plugin --&gt;</span><br><span class="line">&lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure><p>在目录<code>src/main/docker</code>下创建 Dockerfile 文件，Dockerfile 文件用来说明如何来构建镜像。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8-jdk-alpine</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD spring-boot-docker-1.0.jar app.jar</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></pre></td></tr></table></figure><p>这个 Dockerfile 文件很简单，构建 Jdk 基础环境，添加 Spring Boot Jar 到镜像中，简单解释一下:</p><ul><li>FROM ，表示使用 Jdk8 环境 为基础镜像，如果镜像不是本地的会从 DockerHub 进行下载</li><li>VOLUME ，VOLUME 指向了一个<code>/tmp</code>的目录，由于 Spring Boot 使用内置的Tomcat容器，Tomcat 默认使用<code>/tmp</code>作为工作目录。这个命令的效果是：在宿主机的<code>/var/lib/docker</code>目录下创建一个临时文件并把它链接到容器中的<code>/tmp</code>目录</li><li>ADD ，拷贝文件并且重命名</li><li>ENTRYPOINT ，为了缩短 Tomcat 的启动时间，添加<code>java.security.egd</code>的系统属性指向<code>/dev/urandom</code>作为 ENTRYPOINT</li></ul><blockquote><p>这样 Spring Boot 项目添加 Docker 依赖就完成了。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>dockerfile</title>
      <link href="/2019/03/04/2019-03-04-dockerfile/"/>
      <url>/2019/03/04/2019-03-04-dockerfile/</url>
      
        <content type="html"><![CDATA[<h1 id="what"><a href="#what" class="headerlink" title="what"></a>what</h1><p>通过dockerfile写入程序、库、资源、配置参数等，来生成image文件，可以类比node的package.json或者nginx.conf的文件</p><h1 id="format"><a href="#format" class="headerlink" title="format"></a>format</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>#  Dockerfile文件格式</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> This dockerfile uses the ubuntu image</span><br><span class="line"><span class="meta">#</span> VERSION 2 - EDITION 1</span><br><span class="line"><span class="meta">#</span> Author: docker_user</span><br><span class="line"><span class="meta">#</span> Command format: Instruction [arguments / command] ..</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> 1、第一行必须指定 基础镜像信息</span><br><span class="line">FROM ubuntu</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> 2、维护者信息</span><br><span class="line">MAINTAINER docker_user docker_user@email.com</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> 3、镜像操作指令</span><br><span class="line">RUN echo "deb http://archive.ubuntu.com/ubuntu/ raring main universe" &gt;&gt; /etc/apt/sources.list</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y nginx</span><br><span class="line">RUN echo "\ndaemon off;" &gt;&gt; /etc/nginx/nginx.conf</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> 4、容器启动执行指令</span><br><span class="line">CMD /usr/sbin/nginx</span><br></pre></td></tr></table></figure><h2 id="build-image"><a href="#build-image" class="headerlink" title="build image"></a>build image</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build</span><br></pre></td></tr></table></figure><p>运行该命令时，根据dockerfile文件及上下文构建新的docker镜像，其中上下文是指dockerfile所在的本地路径或者网络路径url。</p><p>ps:dokcer build时候，会在后台守护进程daemon中进行，而不是cli（common line interface）中，构建前，构建进程将全部内容递归放到守护进程，将dockerfile文件放在（本就在空目录下构建）该目录下</p><p>还可以通过.dockerignore的文件来忽略上下文目录中的部分文件和目录，同.gitignore</p><p>通过-f命令指定文件位置，如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker buid -f /path/to/dockerfile .</span><br></pre></td></tr></table></figure><h1 id="image-tag"><a href="#image-tag" class="headerlink" title="image tag"></a>image tag</h1><p>镜像标签docker build -t ngix/v3</p><h1 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h1><p>Docker 守护进程会一条一条的执行 Dockerfile 中的指令，而且会在每一步提交并生成一个新镜像，最后会输出最终镜像的ID。生成完成后，Docker 守护进程会自动清理你发送的上下文。 Dockerfile文件中的每条指令会被独立执行，并会创建一个新镜像，RUN cd /tmp等命令不会对下条指令产生影响。 <strong>Docker 会重用已生成的中间镜像</strong>，以加速docker build的构建速度。</p><h1 id="example"><a href="#example" class="headerlink" title="example"></a>example</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mkdir mynginx</span><br><span class="line">cd mynginx</span><br><span class="line">vi Dockerfile</span><br><span class="line"></span><br><span class="line">//制作dokcerfile</span><br><span class="line">FROM nginx</span><br><span class="line">RUN echo '&lt;h1&gt;Hello, Docker!&lt;/h1&gt;' &gt; /usr/share/nginx/html/index.html</span><br><span class="line"></span><br><span class="line">//save &amp;&amp; run this code in mynginx</span><br><span class="line">docker build -t nginx:v1 .</span><br><span class="line">//v1 后面有一个空格和一个点</span><br><span class="line">//点代表当前目录</span><br><span class="line">//查看image</span><br><span class="line">dokcer images</span><br><span class="line"></span><br><span class="line">//run</span><br><span class="line">dokcer run --name docker_nginx_v1 -d -p 80:80 nginx:v1</span><br><span class="line">//docker_nginx_v1为容器名</span><br><span class="line">//nginx:v1为image名</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NoSql-introduction</title>
      <link href="/2019/03/04/2019-03-04-NoSql-introduction/"/>
      <url>/2019/03/04/2019-03-04-NoSql-introduction/</url>
      
        <content type="html"><![CDATA[<h1 id="why-nosql"><a href="#why-nosql" class="headerlink" title="why nosql"></a>why nosql</h1><p>NoSql可以处理结构化，非结构化的数据，可以水平伸缩，在实时和批量数据分析中具有优势</p><h1 id="difference"><a href="#difference" class="headerlink" title="difference"></a>difference</h1>]]></content>
      
      
      <categories>
          
          <category> database </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>docker</title>
      <link href="/2019/03/04/2019-03-04-docker/"/>
      <url>/2019/03/04/2019-03-04-docker/</url>
      
        <content type="html"><![CDATA[<h1 id="why-docker"><a href="#why-docker" class="headerlink" title="why docker"></a>why docker</h1><ol><li>解决“在我的机子上可以正常工作”的问题</li><li>运维更好地管理服务</li><li>更好地迁移和拓展（任意平台运行）</li></ol><h1 id="what-is-docker"><a href="#what-is-docker" class="headerlink" title="what is docker"></a>what is docker</h1><p>docker属于Linux容器的一种封装，和VM类似，但他不像VM一样虚拟在操作系统之上，而是和操作系统平级，程序运行在容器里，就和在真实的物理机上面运行一样</p><p><img src="http://www.itmind.net/assets/images/2018/docker/docker_vs_vm.png" alt="img"></p><p>简单一点理解就是：程序运行在docker上和真机上几乎误差，将程序包装起来管理</p><h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><ul><li><strong>daemon</strong>：守护进程</li><li><strong>Client</strong>：命令行</li><li><strong>image</strong>：镜像，用来创建容器</li><li><strong>container</strong>：运行组件，启动的image就是容器</li><li><strong>registry</strong>：管理image的地方</li></ul><h1 id="install"><a href="#install" class="headerlink" title="install"></a>install</h1><blockquote><p>#<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">ubuntu</a></p><p>$ sudo apt-get install docker-ce docker-ce-cli containerd.io</p></blockquote><h1 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h1><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> sudo docker container run hello-world</span><br><span class="line"><span class="meta">&gt;</span> //他会先找本地，然后再去仓库下载</span><br><span class="line"><span class="meta">&gt;</span> //该过程将image变成容器，即image文件产生container文件</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><blockquote><p>docker pull image_name//拉取镜像</p><p>docker images//本地镜像</p><p>docker rmi xxx//remove image</p><p>docker ps//view what docker is running</p><p>docker ps -a</p></blockquote><blockquote><p>//以下使用<strong>cn</strong>代替 container_name/container_id</p><p>docker start|stop|restart cn</p><p>docker attach cn//启动后进入容器</p><p>dokcer rm cn</p><p>docker info</p><p>docker search nginx</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LineageOS16.0-RELEASE</title>
      <link href="/2019/03/02/2019-03-02-LineageOS16-0-RELEASE/"/>
      <url>/2019/03/02/2019-03-02-LineageOS16-0-RELEASE/</url>
      
        <content type="html"><![CDATA[<h2 id="16-0正式发布"><a href="#16-0正式发布" class="headerlink" title="16.0正式发布"></a>16.0正式发布</h2><p>我们从去年八月开始，努力将我们LineageOs的新特性移植到新版本的安卓上，非常感谢之前版本中的工作者们，我们才能够在这次的版本新特性中投入更多的精力，尤其是，隐私守护（Privacy Guard）和插件（su addon）上收到了了大量的提升建议。<br>通过对Styles API的一些细微更改，他现在可以兼容安卓暗黑模式的默认实现，在未来，越来越多的三方应用将遵循系统风格，这意味着Styles API将允许在跨应用程序时获得更一致的体验。<br>正如我们发布夏季第二次调研结果那样，我们将介绍Trust的新特性，首先是设备锁定时阻止新USB设备连接。请注意，由于基于底层，所以这个特性必须在每个设备底层中启用。Trebuchet现在还可以隐藏app以及在打开app前进行身份验证。该限制也仅在Trebuchet中，并非系统范围。<br>我们认为16.0的分支已经达到了15.1版本的特性测试并做好了发布准备。随着16.0分支成为最新最活跃的分支，在2019.3.1，它将开始日更新构建，并且15.1将会移动到周更新。<br>16.0版本将会从小部分机器开始运行，一些其他的机子如果准备好了，我们也会做一些小改动，开始构建，并通过改动构建脚本来更好地处理我们最新手机的，独特feature，以及由此产生的复杂问题</p><h2 id="支持更新名单"><a href="#支持更新名单" class="headerlink" title="支持更新名单"></a>支持更新名单</h2><ul><li>Asus</li><li>BQ</li><li>Fairphone</li><li>Google</li><li>HTC</li><li>Huawei</li><li>LeEco</li><li>Lenovo</li><li>LG</li><li>Moto</li><li>Nextbit</li><li>Nubia</li><li>Nvdia</li><li>OnePlus(my oneplus 5T receive 16.0)</li><li>Oppo</li><li>Samsung</li><li>Sony</li><li>Wileyfox</li><li>Wingtech</li><li>Xiaomi</li><li>YU</li><li>ZTE</li><li>Zuk</li><li>more</li></ul><h2 id="其他热门的ROM"><a href="#其他热门的ROM" class="headerlink" title="其他热门的ROM"></a>其他热门的ROM</h2><ul><li><a href="https://www.mokeedev.com/" target="_blank" rel="noopener">MoKee</a>]</li><li><a href="https://crdroid.net/" target="_blank" rel="noopener">crDroid</a></li><li><a href="http://www.miui.com/" target="_blank" rel="noopener">MIUI</a></li><li><a href="https://www.flyme.cn/" target="_blank" rel="noopener">Flyme</a></li><li><a href="https://pixelexperience.org/" target="_blank" rel="noopener">PixelExperience</a></li></ul><h2 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h2><blockquote><h2 id="Hello-LineageOS-16-0"><a href="#Hello-LineageOS-16-0" class="headerlink" title="Hello LineageOS 16.0"></a>Hello LineageOS 16.0</h2><p>We’ve been working hard since August to port our unique features to this new version of Android. Thanks to the major cleanup and refactoring done in the previous version, we were able to focus more on features and reliability this time; in particular, both Privacy Guard and the su addon received a sizeable amount of improvements.</p><p>With some minor changes made to the <a href="https://wiki.lineageos.org/sdk/api/styles.html" target="_blank" rel="noopener">Styles API</a>, it is now compatible with what will eventually become the default implementation of dark mode in Android. In the future, more and more third party apps will follow the system style, meaning our Styles API will allow you to have a more coherent experience across apps.</p><p>As we announced when the <a href="https://lineageos.org/Summer-Survey-2-Results/" target="_blank" rel="noopener">Summer Survey 2 results</a> were posted, we will be introducing new features to <a href="https://lineageos.org/Trust-me/" target="_blank" rel="noopener">Trust</a>, beginning with the ability to block new USB device connections when device is locked. Please note that this feature has to be enabled on a per-device basis due to the layer at which this was implemented. Trebuchet is also now able to hide apps and require authentication before opening them. Please note that this restriction is limited to Trebuchet and is not system-wide.</p><p>We feel that the 16.0 branch has reached feature parity with 15.1 and is ready for initial release. With 16.0 being the most recent and most actively-developed branch, on March 1st, 2019 it will begin receiving builds nightly and 15.1 will be moved to weekly builds.</p><p>LineageOS 16.0 will be launching with a small selection of devices. Additional devices will begin receiving builds as they are ready and after we make minor change to our build scripts to better handle the unique features, and resulting complications, of the most modern devices.</p><h3 id="Upgrading-to-LineageOS-16-0"><a href="#Upgrading-to-LineageOS-16-0" class="headerlink" title="Upgrading to LineageOS 16.0"></a>Upgrading to LineageOS 16.0</h3><ol><li><p>(Optional) Make a backup of your important data</p></li><li><p>Download the build either from</p></li></ol><p>   download portal</p><p>   or built in Updater app</p><ul><li>You can export the downloaded package from the Updater app to the sdcard by long-pressing it and then selecting <em>“Export”</em> in the popup menu</li></ul><ol start="3"><li><p>Download proper addons packages (<a href="https://wiki.lineageos.org/gapps.html" target="_blank" rel="noopener">GApps</a>, <a href="https://download.lineageos.org/extras" target="_blank" rel="noopener">su</a>…) for Android 9.0/Lineage OS 16.0</p></li><li><p>Make sure your recovery and firmware are up to date</p></li><li><p>Format your system partition</p></li><li><p>Follow the “Installing LineageOS from recovery” section <a href="https://wiki.lineageos.org/install_guides.html" target="_blank" rel="noopener">on your device’s installation page</a></p></li></ol><p>Please note that if you’re currently on an official build, you <em>DO NOT</em> need to wipe your device.</p><p>If you are installing from an unofficial build, you <em>MUST</em> wipe data from recovery before installing.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> phones </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>java类的加载机制</title>
      <link href="/2019/03/02/2019-03-02-java%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/"/>
      <url>/2019/03/02/2019-03-02-java%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>写在最前面：该文章为笔记，来自<a href="http://www.ityouknow.com" target="_blank" rel="noopener">纯洁的微笑</a></p></blockquote><h1 id="what-is-the-loading-of-class"><a href="#what-is-the-loading-of-class" class="headerlink" title="what is the loading of class"></a>what is the loading of class</h1><p>类加载即：</p><p>将编译class文件中的二进制数据读到内存中方法区，然后在堆区通过java.lang.Class实例化对象，对方法区的数据进行操作</p><p><img src="http://www.itmind.net/assets/images/2017/jvm/jvm-1.png" alt="img"></p><p>该加载过程包含首次使用加载，以及预加载</p><h2 id="加载class文件的方式"><a href="#加载class文件的方式" class="headerlink" title="加载class文件的方式"></a>加载class文件的方式</h2><ul><li>本地</li><li>网络</li><li>zip，jar文件中</li><li>数据库</li><li>动态编译</li></ul><h1 id="类的生命周期"><a href="#类的生命周期" class="headerlink" title="类的生命周期"></a>类的生命周期</h1><p><img src="http://www.itmind.net/assets/images/2017/jvm/class.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ShoppingOffers</title>
      <link href="/2019/03/02/2019-03-02-ShoppingOffers/"/>
      <url>/2019/03/02/2019-03-02-ShoppingOffers/</url>
      
        <content type="html"><![CDATA[<h1 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h1><blockquote><p>In LeetCode Store, there are some kinds of items to sell. Each item has a price.</p><p>However, there are some special offers, and a special offer consists of one or more different kinds of items with a sale price.</p><p>You are given the each item’s price, a set of special offers, and the number we need to buy for each item. The job is to output the lowest price you have to pay for <strong>exactly</strong> certain items as given, where you could make optimal use of the special offers.</p><p>Each special offer is represented in the form of an array, the last number represents the price you need to pay for this special offer, other numbers represents how many specific items you could get if you buy this offer.</p><p>You could use any of special offers as many times as you want.</p></blockquote><h1 id="examples"><a href="#examples" class="headerlink" title="examples"></a>examples</h1><blockquote><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [2,5], [[3,0,5],[1,2,10]], [3,2]</span><br><span class="line">&gt; Output: 14</span><br><span class="line">&gt; Explanation: </span><br><span class="line">&gt; There are two kinds of items, A and B. Their prices are $2 and $5 respectively. </span><br><span class="line">&gt; In special offer 1, you can pay $5 for 3A and 0B</span><br><span class="line">&gt; In special offer 2, you can pay $10 for 1A and 2B. </span><br><span class="line">&gt; You need to buy 3A and 2B, so you may pay $10 for 1A and 2B (special offer #2), and $4 for 2A.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [2,3,4], [[1,1,0,4],[2,2,1,9]], [1,2,1]</span><br><span class="line">&gt; Output: 11</span><br><span class="line">&gt; Explanation: </span><br><span class="line">&gt; The price of A is $2, and $3 for B, $4 for C. </span><br><span class="line">&gt; You may pay $4 for 1A and 1B, and $9 for 2A ,2B and 1C. </span><br><span class="line">&gt; You need to buy 1A ,2B and 1C, so you may pay $4 for 1A and 1B (special offer #1), and $3 for 1B, $4 for 1C. </span><br><span class="line">&gt; You cannot add more items, though only $9 for 2A ,2B and 1C.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShoppingOffers</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">/*以下贴出测试方式，因为对ArrayList不熟悉，如有更好的方式，欢迎指出*/</span></span><br><span class="line">List&lt;Integer&gt; price = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; special = <span class="keyword">new</span> ArrayList&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">List&lt;Integer&gt; needs = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">price.add(<span class="number">0</span>, <span class="number">2</span>);price.add(<span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">Integer[][] arr = <span class="keyword">new</span> Integer[][] &#123;&#123;<span class="number">3</span>,<span class="number">0</span>,<span class="number">5</span>&#125;,&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">10</span>&#125;&#125;;</span><br><span class="line">special.add((List&lt;Integer&gt;)Arrays.asList(arr[<span class="number">0</span>]));</span><br><span class="line">special.add((List&lt;Integer&gt;)Arrays.asList(arr[<span class="number">1</span>]));</span><br><span class="line">needs.add(<span class="number">0</span>,<span class="number">3</span>);needs.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">ShoppingOffers so = <span class="keyword">new</span> ShoppingOffers();</span><br><span class="line"><span class="keyword">int</span> res = so.shoppingOffers(price, special, needs);</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">int</span> <span class="title">shoppingOffers</span><span class="params">(List &lt; Integer &gt; price, List &lt; List &lt; Integer &gt;&gt; special, List &lt; Integer &gt; needs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> shopping(price, special, needs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">int</span> <span class="title">shopping</span><span class="params">(List &lt; Integer &gt; price, List &lt; List &lt; Integer &gt;&gt; special, List &lt; Integer &gt; needs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>, res = dot(needs, price);</span><br><span class="line">        <span class="keyword">for</span> (List &lt; Integer &gt; s: special) &#123;</span><br><span class="line">            ArrayList &lt; Integer &gt; clone = <span class="keyword">new</span> ArrayList &lt; &gt; (needs);</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; needs.size(); j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> diff = clone.get(j) - s.get(j);</span><br><span class="line">                <span class="keyword">if</span> (diff &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                clone.set(j, diff);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j == needs.size())</span><br><span class="line">                res = Math.min(res, s.get(j) + shopping(price, special, clone));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dot</span><span class="params">(List &lt; Integer &gt; needs, List &lt; Integer &gt; price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; needs.size(); i++) &#123;</span><br><span class="line">            sum += needs.get(i) * price.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>本题目采用动态规划的思路，我们带入测试样例1的</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;Input: [2,5], [[3,0,5],[1,2,10]], [3,2]</span><br><span class="line">&gt;即A=$2,B=$5</span><br><span class="line">&gt;3A=5$,1A+2B=10$</span><br><span class="line">&gt;需购买3A+2B</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><table><thead><tr><th style="text-align:left">尝试</th><th>price</th></tr></thead><tbody><tr><td style="text-align:left">1:单买</td><td>16</td></tr><tr><td style="text-align:left">2单买302套餐，还差2个B，则先算出2B的res为10，先试305套餐，A买超了，则退出305套餐，此时还有1210套餐，A买多了，退出套餐，两个套餐试完了，得到了单买两个B，$10的套餐，总价就为15元，</td><td>15（覆盖16）</td></tr><tr><td style="text-align:left">3单买1210套餐，还差2A，0B，费用目前10元，先单买2A，费用4元，总价14元，然后先尝试305套餐，发现超，然后再试1210套餐，发现B超了，得到目前最低费用为14元</td><td>14（覆盖15）</td></tr></tbody></table><p>问题的关键就在于clone的精髓之处，用来记录还需要多少零件的个数，使用递归，进行操作。如果不符合，（如买超了）直接break后，重新计算clone，直到special方法都试完了，然后才返回，如果一直都是break的状态则会返回单买的价格。</p><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer res;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">shoppingOffers</span><span class="params">(List&lt;Integer&gt; price, List&lt;List&lt;Integer&gt;&gt; special, List&lt;Integer&gt; needs)</span> </span>&#123;</span><br><span class="line">        res=Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">int</span>[] parr=<span class="keyword">new</span> <span class="keyword">int</span>[price.size()];</span><br><span class="line">        <span class="keyword">int</span>[] aarr=<span class="keyword">new</span> <span class="keyword">int</span>[needs.size()];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;parr.length; i++)&#123;</span><br><span class="line">            parr[i]=price.get(i);</span><br><span class="line">            aarr[i]=needs.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        findMinimum(special, <span class="number">0</span>, aarr, parr, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">findMinimum</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; special, <span class="keyword">int</span> curOffer, <span class="keyword">int</span>[] remain, <span class="keyword">int</span>[] single, <span class="keyword">int</span> total)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(total&gt;=res||curOffer==special.size()) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> buyNow=buySingle(remain, single, total);</span><br><span class="line">        <span class="keyword">if</span>(buyNow&lt;res) res=buyNow;</span><br><span class="line">        <span class="keyword">int</span>[] newRemain=remainAfterUse(special.get(curOffer), remain);</span><br><span class="line">        <span class="keyword">if</span>(newRemain!=<span class="keyword">null</span>) findMinimum(special, curOffer, newRemain, single, total+special.get(curOffer).get(remain.length));</span><br><span class="line">        findMinimum(special, curOffer+<span class="number">1</span>, remain, single, total);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] remainAfterUse(List&lt;Integer&gt; special, <span class="keyword">int</span>[] remain)&#123;</span><br><span class="line">        <span class="keyword">int</span>[] res=<span class="keyword">new</span> <span class="keyword">int</span>[remain.length];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;remain.length;i++)&#123;</span><br><span class="line">            res[i]=remain[i]-special.get(i);</span><br><span class="line">            <span class="keyword">if</span>(res[i]&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">buySingle</span><span class="params">(<span class="keyword">int</span>[] remain, <span class="keyword">int</span>[] single, <span class="keyword">int</span> total)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;remain.length; i++)&#123;</span><br><span class="line">            total+=remain[i]*single[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Node10值得关注的升级</title>
      <link href="/2019/02/23/2019-02-23-Node10%E5%80%BC%E5%BE%97%E5%85%B3%E6%B3%A8%E7%9A%84%E5%8D%87%E7%BA%A7/"/>
      <url>/2019/02/23/2019-02-23-Node10%E5%80%BC%E5%BE%97%E5%85%B3%E6%B3%A8%E7%9A%84%E5%8D%87%E7%BA%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="http2"><a href="#http2" class="headerlink" title="http2"></a>http2</h1><h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ul><li>更有效的网络利用率</li><li>引入 HTTP Header 压缩减小报文体积</li><li>在同一个连接中支持多路并发</li><li>支持 Server Push</li></ul><h2 id="多路复用（Multiplexing）"><a href="#多路复用（Multiplexing）" class="headerlink" title="多路复用（Multiplexing）"></a>多路复用（Multiplexing）</h2><p>由于HTTP连接，起初有要求限制同一域名下的请求有数量限制，超过则被阻塞，而HTTP2可以发起多重请求，如同时请求样式文件和脚本文件</p><h2 id="二进制分帧"><a href="#二进制分帧" class="headerlink" title="二进制分帧"></a>二进制分帧</h2><p><img src="https://pic4.zhimg.com/80/906e22193e61cd561325d93aae0f1e07_hd.jpg" alt="img"></p><p>HTTP/2 通过让所有数据流共用同一个连接，可以更有效地使用 TCP 连接，让高带宽也能真正的服务于 HTTP 的性能提升。</p><p><img src="https://pic1.zhimg.com/80/4bc1ad44e91207d56493003bf3805048_hd.png" alt="img"></p><p>http2.0的格式定义更接近tcp层的方式，这张二机制的方式十分高效且精简。length定义了整个frame的开始到结束，type定义frame的类型（一共10种），flags用bit位定义一些重要的参数，stream id用作流控制，剩下的payload就是request的正文了。</p><h2 id="server-Push"><a href="#server-Push" class="headerlink" title="server Push"></a>server Push</h2><p>http2.0能通过push的方式将客户端需要的内容预先推送过去</p><h2 id="首部压缩（Header-Compression"><a href="#首部压缩（Header-Compression" class="headerlink" title="首部压缩（Header Compression)"></a>首部压缩（Header Compression)</h2><hr><h2 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a><strong>BigInt</strong></h2><hr><h2 id="fs-mkdir-和-fs-mkdirSync-支持递归参数"><a href="#fs-mkdir-和-fs-mkdirSync-支持递归参数" class="headerlink" title="*fs.mkdir 和 fs.mkdirSync 支持递归参数"></a>*<em>fs.mkdir 和 fs.mkdirSync 支持递归参数</em></h2><hr><h2 id="CLI-Flag-自动补全"><a href="#CLI-Flag-自动补全" class="headerlink" title="CLI Flag 自动补全"></a><strong>CLI Flag 自动补全</strong></h2><hr><h2 id="Windows-安装包优化"><a href="#Windows-安装包优化" class="headerlink" title="Windows 安装包优化"></a><strong>Windows 安装包优化</strong></h2><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Egg支持JS智能提醒</title>
      <link href="/2019/02/23/2019-02-23-Egg%E6%94%AF%E6%8C%81JSTS%E6%99%BA%E8%83%BD%E6%8F%90%E9%86%92/"/>
      <url>/2019/02/23/2019-02-23-Egg%E6%94%AF%E6%8C%81JSTS%E6%99%BA%E8%83%BD%E6%8F%90%E9%86%92/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文章思路来自<a href="https://zhuanlan.zhihu.com/p/56780733" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/56780733</a></p></blockquote><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><p>其实由于Egg本身的动态加载机制，所以JavaScript很难去做智能提醒（如变量定义检查），本次借鉴TS的动态生成d.ts，使用ts的Declaration Merging（声明合并）特性，读取JSDoc注释。</p><h2 id="获取"><a href="#获取" class="headerlink" title="获取"></a>获取</h2><ul><li>更新egg-bin模块</li><li>package.json 添加 “egg”: { “declarations”: true } </li></ul><p>实操，升级个人GitHub项目<a href="https://github.com/ShawnGoethe/chum" target="_blank" rel="noopener">chum</a>,执行</p><blockquote><p>npm i egg-bin</p></blockquote><p>将其从4.9.0–&gt;4.11.0并在package.json的尾部加上上述egg的kv，在根目录下生成tpyping文件夹，将app目录下的controller，model，以及根目录下的index，config目录都进行了ts文件生成</p><p><img src="C:\Users\56932\AppData\Roaming\Typora\typora-user-images\1550905277423.png" alt="1550905277423"></p><p>其实egg原生支持JavaScript，对于TS只是支持不推荐的态度，并没有使用TS去重构，本次智能提醒，应该是对JS一个劣势的补齐，解决方案也似乎借鉴了TS的方式，但又保留了人们书写JS的习惯</p>]]></content>
      
      
      <categories>
          
          <category> framework </category>
          
      </categories>
      
      
        <tags>
            
            <tag> egg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ThreeSum</title>
      <link href="/2019/02/19/2019-02-19-15ThreeSum/"/>
      <url>/2019/02/19/2019-02-19-15ThreeSum/</url>
      
        <content type="html"><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Given an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? Find all unique triplets in the array which gives the sum of zero.</span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line"></span><br><span class="line">The solution set must not contain duplicate triplets.</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line"></span><br><span class="line">Given array nums = [-1, 0, 1, 2, -1, -4],</span><br><span class="line"></span><br><span class="line">A solution set is:</span><br><span class="line">[</span><br><span class="line">  [-1, 0, 1],</span><br><span class="line">  [-1, -1, 2]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        ArrayList&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">2</span>; i++)&#123;</span><br><span class="line">            <span class="comment">// 跳过重复元素</span></span><br><span class="line">            <span class="keyword">if</span>(i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i-<span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">// 计算2Sum</span></span><br><span class="line">            ArrayList&lt;List&lt;Integer&gt;&gt; curr = twoSum(nums, i, <span class="number">0</span> - nums[i]);</span><br><span class="line">            res.addAll(curr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;List&lt;Integer&gt;&gt; twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> target)&#123;</span><br><span class="line">        <span class="keyword">int</span> left = i + <span class="number">1</span>, right = nums.length - <span class="number">1</span>;</span><br><span class="line">        ArrayList&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">        <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[left] + nums[right] == target)&#123;</span><br><span class="line">                ArrayList&lt;Integer&gt; curr = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">                curr.add(nums[i]);</span><br><span class="line">                curr.add(nums[left]);</span><br><span class="line">                curr.add(nums[right]);</span><br><span class="line">                res.add(curr);</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    left++;</span><br><span class="line">                &#125;<span class="keyword">while</span>(left &lt; nums.length &amp;&amp; nums[left] == nums[left-<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    right--;</span><br><span class="line">                &#125; <span class="keyword">while</span>(right &gt;= <span class="number">0</span> &amp;&amp; nums[right] == nums[right+<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[left] + nums[right] &gt; target)&#123;</span><br><span class="line">                right--;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Key"><a href="#Key" class="headerlink" title="Key"></a>Key</h1><p>tips：很久没有写Java了，花了点时间去整理了一些知识，所以上面的算法其实是ctrl+v的，现在整理一下list相关的知识：</p><p>1.List&lt;List<integer>&gt;为嵌套的list集合，声明方式</integer></p><blockquote><p><em>List&lt;List<strong><interger></interger></strong>&gt; list = new Array<strong><interger></interger></strong>()</em></p><p>or</p><p>List&lt;List<integer>&gt; list = new ArrayList&lt;&gt;();//recomend</integer></p></blockquote><p>2.List是一个接口，而ArrayList是List接口的一个实现类</p><blockquote><p>List list = new List();//是错误的用法</p><p>List list = new ArrayList();//list会丢失ArrayList的trimToSize()方法</p><p>ArrayList list=newArrayList()</p></blockquote><p>3.然后明天再回来重新写这道题</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>缓存</title>
      <link href="/2019/02/19/2019-02-19-%E7%BC%93%E5%AD%98/"/>
      <url>/2019/02/19/2019-02-19-%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<h1 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h1><h2 id="why"><a href="#why" class="headerlink" title="why"></a>why</h2><ul><li><p>高性能</p><p>例如：把查完的值缓存，下次直接访问</p></li><li><p>高并发</p><p>例如：把请求排队</p></li></ul><h2 id="difference（vs-memcached"><a href="#difference（vs-memcached" class="headerlink" title="difference（vs memcached)"></a>difference（vs memcached)</h2><table><thead><tr><th>特征</th><th>redis</th><th>memchched</th></tr></thead><tbody><tr><td>数据结构</td><td>更复杂的数据结构，更丰富的数据操作</td><td></td></tr><tr><td>集群</td><td>支持</td><td>不支持</td></tr><tr><td>性能</td><td>单核</td><td>多核</td></tr></tbody></table><h2 id="redis线程模型"><a href="#redis线程模型" class="headerlink" title="redis线程模型"></a>redis线程模型</h2><p>redis 内部使用文件事件处理器 <code>file event handler</code>，这个文件事件处理器是单线程的，所以 redis 才叫做单线程的模型。它采用 IO 多路复用机制同时监听多个 socket，根据 socket 上的事件来选择对应的事件处理器进行处理。</p><p>假设一个 Redis 服务器正在运作， 那么这个服务器的监听套接字的 <code>AE_READABLE</code> 事件应该正处于监听状态之下， 而该事件所对应的处理器为连接应答处理器。</p><p>如果这时有一个 Redis 客户端向服务器发起连接， 那么监听套接字将产生 <code>AE_READABLE</code> 事件， 触发连接应答处理器执行： 处理器会对客户端的连接请求进行应答， 然后创建客户端套接字， 以及客户端状态， 并将客户端套接字的 <code>AE_READABLE</code> 事件与命令请求处理器进行关联， 使得客户端可以向主服务器发送命令请求。</p><p>之后， 假设客户端向主服务器发送一个命令请求， 那么客户端套接字将产生 <code>AE_READABLE</code> 事件， 引发命令请求处理器执行， 处理器读取客户端的命令内容， 然后传给相关程序去执行。</p><p><img src="https://github.com/doocs/advanced-java/raw/master/images/redis-single-thread-model.png" alt="redis-single-thread-model"></p><p>执行命令将产生相应的命令回复， 为了将这些命令回复传送回客户端， 服务器会将客户端套接字的 <code>AE_WRITABLE</code> 事件与命令回复处理器进行关联： 当客户端尝试读取命令回复的时候， 客户端套接字将产生 <code>AE_WRITABLE</code> 事件， 触发命令回复处理器执行， 当命令回复处理器将命令回复全部写入到套接字之后， 服务器就会解除客户端套接字的 <code>AE_WRITABLE</code> 事件与命令回复处理器之间的关联。</p>]]></content>
      
      
      <categories>
          
          <category> high_availability </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>联合索引</title>
      <link href="/2019/02/19/2019-02-19-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95/"/>
      <url>/2019/02/19/2019-02-19-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95/</url>
      
        <content type="html"><![CDATA[<h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>当具备多个索引的时候，如：KEY <code>联合索引</code> (<code>a</code>,<code>b</code>,<code>c</code>)为索引，除(b,c)条件索引不会触发该索引表外，(a,b),(a,c),(a,b,c)均会触发上述联合索引，具体可参见explain的key类型，理论应该显示联立索引</p><p>如：</p><blockquote><p>EXPLAIN SELECT <em> FROM TABLENAME WHERE a=’2222’ AND b=</em>‘222’*</p></blockquote><p>如果你设置多个单列索引，在explain下，key的值就为其单列的索引，如上述的a列</p>]]></content>
      
      
      <categories>
          
          <category> database </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树的后序遍历</title>
      <link href="/2019/02/19/2019-02-19-%E6%A0%91%E7%9A%84%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86/"/>
      <url>/2019/02/19/2019-02-19-%E6%A0%91%E7%9A%84%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<h1 id="definition"><a href="#definition" class="headerlink" title="definition"></a>definition</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private static class BinaryNode&lt;AnyType&gt;</span><br><span class="line">&#123;</span><br><span class="line">    BinaryNode(AnyType theElement)</span><br><span class="line">    &#123;</span><br><span class="line">        this(theElement, null, null);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BinaryNode(AnyType theElement, BinaryNode&lt;AnyType&gt; lt, BinaryNode&lt;AnyType&gt; rt)</span><br><span class="line">    &#123;</span><br><span class="line">        element = theElement;</span><br><span class="line">        left = lt;</span><br><span class="line">        right = rt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    AnyType element;</span><br><span class="line">    BinaryNode&lt;AnyType&gt; left;</span><br><span class="line">    BinaryNode&lt;AnyType&gt; right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private BinaryNode&lt;AnyType&gt; root;</span><br></pre></td></tr></table></figure><h1 id="posOrder"><a href="#posOrder" class="headerlink" title="posOrder"></a>posOrder</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">posOrder</span><span class="params">(BinaryNode&lt;AnyType&gt; Node)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Node != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            posOrder(Node.left);</span><br><span class="line">            posOrder(Node.right);</span><br><span class="line">            System.out.print(Node.element + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public void posOrder(BinaryNode&lt;AnyType&gt; Node)</span><br><span class="line">&#123;</span><br><span class="line">    Stack&lt;BinaryNode&gt; stack1 = new Stack&lt;&gt;();</span><br><span class="line">    Stack&lt;Integer&gt; stack2 = new Stack&lt;&gt;();</span><br><span class="line">    int i = 1;</span><br><span class="line">    while(Node != null || !stack1.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        while (Node != null)</span><br><span class="line">        &#123;</span><br><span class="line">            stack1.push(Node);</span><br><span class="line">            stack2.push(0);</span><br><span class="line">            Node = Node.left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        while(!stack1.empty() &amp;&amp; stack2.peek() == i)</span><br><span class="line">        &#123;</span><br><span class="line">            stack2.pop();</span><br><span class="line">            System.out.print(stack1.pop().element + &quot;   &quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(!stack1.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            stack2.pop();</span><br><span class="line">            stack2.push(1);</span><br><span class="line">            Node = stack1.peek();</span><br><span class="line">            Node = Node.right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> algorithm </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>表内关联</title>
      <link href="/2019/02/19/2019-02-19-%E8%A1%A8%E5%86%85%E5%85%B3%E8%81%94/"/>
      <url>/2019/02/19/2019-02-19-%E8%A1%A8%E5%86%85%E5%85%B3%E8%81%94/</url>
      
        <content type="html"><![CDATA[<h1 id="Inner-Join"><a href="#Inner-Join" class="headerlink" title="Inner Join"></a>Inner Join</h1><blockquote><p>SELECT column_list<br>FROM t1<br>INNER JOIN t2 ON join_condition1<br>INNER JOIN t3 ON join_condition2<br>…<br>WHERE where_conditions;</p></blockquote><h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><table><thead><tr><th>id</th><th>name</th><th>parentid</th></tr></thead><tbody><tr><td>1</td><td>北京市</td><td>0</td></tr><tr><td>2</td><td>海淀区</td><td>1</td></tr><tr><td>3</td><td>北京xx大学</td><td>2</td></tr></tbody></table><blockquote><p>select a.name 市,b.name 区,c.name 名<br>from address a<br>join address  b on b.parentid = a.id<br>join address  c on c.parentid = b.id<br>join address  d on d.parentid = c.id</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> database </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LongestCommonPrefix</title>
      <link href="/2019/02/18/2019-02-18-LongestCommonPrefix/"/>
      <url>/2019/02/18/2019-02-18-LongestCommonPrefix/</url>
      
        <content type="html"><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote><p>Write a function to find the longest common prefix string amongst an array of strings.</p><p>If there is no common prefix, return an empty string <code>&quot;&quot;</code>.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]</span><br><span class="line">&gt; Output: &quot;fl&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Input: [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]</span><br><span class="line">&gt; Output: &quot;&quot;</span><br><span class="line">&gt; Explanation: There is no common prefix among the input strings.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><strong>Note:</strong></p><p>All given inputs are in lowercase letters <code>a-z</code>.</p></blockquote><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestCommonPrefix</span><span class="params">(String[] strs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> minLength = minLength(strs);</span><br><span class="line">String same = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">boolean</span> isSame=<span class="keyword">false</span>;</span><br><span class="line">outer:<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;minLength;i++) &#123;</span><br><span class="line"><span class="keyword">char</span> sameCharacter = strs[<span class="number">0</span>].charAt(i);</span><br><span class="line">isSame = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;strs.length;j++) &#123;</span><br><span class="line"><span class="keyword">if</span>(strs[j].charAt(i)==sameCharacter) &#123;</span><br><span class="line">isSame = <span class="keyword">true</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">isSame = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">break</span> outer;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(isSame=<span class="keyword">true</span>)same+=sameCharacter;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> same;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">minLength</span><span class="params">(String[] strs)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">if</span>(strs.length==<span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> min = strs[<span class="number">0</span>].length();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;strs.length;i++) &#123;</span><br><span class="line"><span class="keyword">if</span>(strs[i].length()&lt;min) &#123;</span><br><span class="line">min = strs[i].length();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> min;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="key"><a href="#key" class="headerlink" title="key"></a>key</h1><p>数学题，没什么关键，但是这个解法，还是存在优化空间</p><h1 id="Perfect"><a href="#Perfect" class="headerlink" title="Perfect"></a>Perfect</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestCommonPrefix</span><span class="params">(String[] strs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strs == <span class="keyword">null</span> || strs.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        String prefix = strs[<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; strs.length; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!strs[i].startsWith(prefix)) &#123;</span><br><span class="line">                prefix = prefix.substring(<span class="number">0</span>, prefix.length() - <span class="number">1</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (prefix.isEmpty()) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ReverseInteger</title>
      <link href="/2019/02/17/2019-02-17-ReverseInteger/"/>
      <url>/2019/02/17/2019-02-17-ReverseInteger/</url>
      
        <content type="html"><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><p>Given a 32-bit signed integer, reverse digits of an integer.</p><p>Example 1:</p><p>Input: 123<br>Output: 321<br>Example 2:</p><p>Input: -123<br>Output: -321<br>Example 3:</p><p>Input: 120<br>Output: 21<br>Note:<br>Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [−231,  231 − 1]. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> result =<span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> result_l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">result_l = result_l * <span class="number">10</span> + x % <span class="number">10</span>;</span><br><span class="line">x = x / <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(result_l &gt;= Integer.MAX_VALUE||result_l &lt;= Integer.MIN_VALUE) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">result = (<span class="keyword">int</span>) result_l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="keys"><a href="#keys" class="headerlink" title="keys"></a>keys</h1><p>1.倒序很简单，取余赋给新数就可以了，不过注意JavaScript或者Python的int–&gt;float的情况</p><p>2.题目下面其实提示了int的范围，改题目1032个测试数据，有大概7个是超范围的验证数据，所以java中可以巧利用Integer.MAX来进行处理。</p><h1 id="perfect"><a href="#perfect" class="headerlink" title="perfect"></a>perfect</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">            res = res * <span class="number">10</span> + x % <span class="number">10</span>;</span><br><span class="line">            x = x / <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)res == res ? (<span class="keyword">int</span>)res : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>如何生成tag和categories</title>
      <link href="/2019/02/17/2019-02-17-%E5%A6%82%E4%BD%95%E7%94%9F%E6%88%90tag%E5%92%8Ccategories/"/>
      <url>/2019/02/17/2019-02-17-%E5%A6%82%E4%BD%95%E7%94%9F%E6%88%90tag%E5%92%8Ccategories/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>为什么使用消息队列MQ</title>
      <link href="/2019/01/24/2019-01-24-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97MQ/"/>
      <url>/2019/01/24/2019-01-24-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97MQ/</url>
      
        <content type="html"><![CDATA[<p>从实习到后来的两份工作也写了不少的项目，在最近的一份工作用到了大量的消息队列（客服系统，会有大量的访客咨询消息），让我重新回顾了一下在大数据面前，为什么要用消息队列，怎么用好消息队列</p><h2 id="理由"><a href="#理由" class="headerlink" title="理由"></a>理由</h2><ul><li>解耦</li><li>异步</li><li>削峰</li></ul><h2 id="解耦"><a href="#解耦" class="headerlink" title="解耦"></a>解耦</h2><p>通过一个 MQ，Pub/Sub 发布订阅消息这么一个模型，不同微服务之间通信会更加解耦，A给BCDEF发送消息的时候，就不需要考虑他们是否宕机，如何重发等，只需要将信息发送到队列里，让他们自己去取就好了</p><h2 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h2><p>假设用户请求需要写表，那么吧任务放进队列里，等待写入，前端可以先返回，可以减少用户的等待时间，或者采用多个机器同时写数据的不同部分，加快数据的处理</p><h2 id="削峰"><a href="#削峰" class="headerlink" title="削峰"></a>削峰</h2><p>就和平时用电一样，晚上电网的压力肯定会很大，如果直接把大量请求压到服务器，会直接宕机，但如果把请求排成队列，然后服务器从里面顺序取，虽然会增加延迟，但是不会宕机，满负荷运作而已</p><h2 id="实际生产环境"><a href="#实际生产环境" class="headerlink" title="实际生产环境"></a>实际生产环境</h2><p>咨询系统大致分为：咨询核心，端模块，微信模块，分配模块等等，访客发送的咨询信息（web）可能先经过端模块，在咨询核心模块处理前进入队列，然后，分配模块根据用户的设置，如接入客服还是机器人，按什么权重进行分配，分配给哪一个业务组进行操作，来减轻咨询核心的压力</p><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>1.系统可用性降低（MQ挂了咋整）</p><p>2.复杂度提升（消息没有重复消费，不会丢失）</p><p>3.一致性问题有待解决</p><table><thead><tr><th>特性</th><th>ActiveMQ</th><th>RabbitMQ</th><th>RocketMQ</th><th style="text-align:center">Kafka</th></tr></thead><tbody><tr><td>单机吞吐量</td><td>万级，比 RocketMQ、Kafka 低一个数量级</td><td>同 ActiveMQ</td><td>10 万级，支撑高吞吐</td><td style="text-align:center">10 万级，高吞吐，一般配合大数据类的系统来进行实时数据计算、日志采集等场景</td></tr><tr><td>topic 数量对吞吐量的影响</td><td></td><td></td><td>topic 可以达到几百/几千的级别，吞吐量会有较小幅度的下降，这是 RocketMQ 的一大优势，在同等机器下，可以支撑大量的 topic</td><td style="text-align:center">topic 从几十到几百个时候，吞吐量会大幅度下降，在同等机器下，Kafka 尽量保证 topic 数量不要过多，如果要支撑大规模的 topic，需要增加更多的机器资源</td></tr><tr><td>时效性</td><td>ms 级</td><td>微秒级，这是 RabbitMQ 的一大特点，延迟最低</td><td>ms 级</td><td style="text-align:center">延迟在 ms 级以内</td></tr><tr><td>可用性</td><td>高，基于主从架构实现高可用</td><td>同 ActiveMQ</td><td>非常高，分布式架构</td><td style="text-align:center">非常高，分布式，一个数据多个副本，少数机器宕机，不会丢失数据，不会导致不可用</td></tr><tr><td>消息可靠性</td><td>有较低的概率丢失数据</td><td>基本不丢</td><td>经过参数优化配置，可以做到 0 丢失</td><td style="text-align:center">同 RocketMQ</td></tr><tr><td>功能支持</td><td>MQ 领域的功能极其完备</td><td>基于 erlang 开发，并发能力很强，性能极好，延时很低</td><td>MQ 功能较为完善，还是分布式的，扩展性好</td><td style="text-align:center">功能较为简单，主要支持简单的 MQ 功能，在大数据领域的实时计算以及日志采集被大规模使用</td></tr></tbody></table><p>所以<strong>中小型公司</strong>，用 RabbitMQ 是不错的选择</p><p><strong>大型公司</strong>，基础架构研发实力较强，用 RocketMQ 是很好的选择</p><p>如果是<strong>大数据领域</strong>的实时计算、日志采集等场景，用 Kafka 是业内标准的，绝对没问题，社区活跃度很高，绝对不会黄，何况几乎是全世界这个领域的事实性规范。</p>]]></content>
      
      
      <categories>
          
          <category> high_availability </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>递归优化</title>
      <link href="/2019/01/23/2019-01-23-%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/"/>
      <url>/2019/01/23/2019-01-23-%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="递归优化"><a href="#递归优化" class="headerlink" title="递归优化"></a>递归优化</h1><h2 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h2><p>在 Java 中，每个线程都有独立的 Java 虚拟机栈。栈具有后入先出的特点，递归调用也是需要后调用的方法先返回，因此使用栈来存储递归调用的信息。这些信息存储在栈帧中，每个 Java 方法在执行时都会创建一个栈帧，用来存储<strong>局部变量表</strong>、<strong>操作数栈</strong>、<strong>常量池引用</strong>等信息。在调用方法时，对应着一个栈帧入栈，而方法返回时，对应着一个栈帧出栈。</p><p><img src="https://diycode.b0.upaiyun.com/photo/2019/46adce788e4fe23ed9e196deb76d8d71.png" alt="img"></p><p>随着栈帧frame的增多，将会导致Stack Overflow的报错，例如</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">1</span> || i == <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> (f(i - <span class="number">1</span>) + f(i - <span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="解决方法1：递归–-gt-非递归"><a href="#解决方法1：递归–-gt-非递归" class="headerlink" title="解决方法1：递归–&gt;非递归"></a>解决方法1：递归–&gt;非递归</h2><p>其实很简单，就是用一个临时变量，来保存中间的值，而不是压入堆栈中，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//费波纳列数列，前两位是1，之后没位数是前两位数的和</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp1=<span class="number">1</span>,temp2=<span class="number">1</span>,temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;=n ; i++) &#123;</span><br><span class="line">        temp=temp1+temp2;</span><br><span class="line">        temp1=temp2;</span><br><span class="line">        temp2=temp;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//粘贴于网上</span></span><br></pre></td></tr></table></figure><h2 id="解决办法2：递归–-gt-尾递归"><a href="#解决办法2：递归–-gt-尾递归" class="headerlink" title="解决办法2：递归–&gt;尾递归"></a>解决办法2：递归–&gt;尾递归</h2><p>尾递归就是当函数在最后一步（尾部）调用自身，如：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">f</span><span class="params">(x)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> g(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下算法来自阮一峰教程：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">factorial</span><span class="params">(n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">factorial(<span class="number">5</span>) <span class="comment">// 120</span></span><br></pre></td></tr></table></figure><p>该算法并非是尾递归，因为其在返回值的时候进行了一个乘法操作，所以还是普通的递归，复杂度为O(n)，而如果改成尾递归，则：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">factorial</span><span class="params">(n, total)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">factorial(<span class="number">5</span>, <span class="number">1</span>) <span class="comment">// 120</span></span><br></pre></td></tr></table></figure><p>该算法只需要计算</p><p>factorial(5,1)</p><p>factorial(4,5)</p><p>factorial(3,20)</p><p>factorial(2,60)</p><p>factorial(1,120)</p><p>在进入新的递归函数时，尾递归不再需要使用栈帧保存数据，允许抛弃旧的栈帧，那么只需要保存一个栈帧即可</p><h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><ul><li>[阮一峰尾递归]（<a href="http://www.ruanyifeng.com/blog/2015/04/tail-call.html）" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/04/tail-call.html）</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> regreesion </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
